import{j as e}from"./ui-UIpCtT3r.js";import{r as u,a as $}from"./vendor-vA4cx1mx.js";import{u as T,t as k,o as M,s as l,e as O}from"./zod-BPPSwYm9.js";import{u as R}from"./router-CxXythJb.js";import{I as o}from"./input-BDDyNkir.js";import{j as q,u as U,B as E,k as P,t as g}from"./index-_oaftgoR.js";import{C as A}from"./circle-check-big-BHshGvXV.js";import{C as I}from"./calendar-DopD1FE2.js";import{M as L}from"./mail-CGmiO6Ue.js";import{L as y}from"./lock-d4eNrzYj.js";import{E as w}from"./eye-off-CHs7aNr5.js";import{E as j}from"./eye-is0de_GS.js";import{U as F}from"./user-DI_JL3j7.js";import{U as J}from"./users-FiLp6VlV.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=q("IdCard",[["path",{d:"M16 10h2",key:"8sgtl7"}],["path",{d:"M16 14h2",key:"epxaof"}],["path",{d:"M6.17 15a3 3 0 0 1 5.66 0",key:"n6f512"}],["circle",{cx:"9",cy:"11",r:"2",key:"yxgjnd"}],["rect",{x:"2",y:"5",width:"20",height:"14",rx:"2",key:"qneu4z"}]]),G=M({email:l().email({message:"Email inválido"}),password:l().min(6,{message:"Senha deve ter pelo menos 6 caracteres"})}),W=M({email:l().email({message:"Email inválido"}),password:l().min(6,{message:"Senha deve ter pelo menos 6 caracteres"}),confirmPassword:l(),name:l().min(1,{message:"Nome é obrigatório"}),phone:l().min(10,{message:"Telefone é obrigatório"}).regex(/^\d{10,15}$/,{message:"Telefone inválido"}),cpf:l().min(11,{message:"CPF é obrigatório"}),userType:O(["client","provider"])}).refine(d=>d.password===d.confirmPassword,{message:"As senhas não conferem",path:["confirmPassword"]});function ie(){const[d,N]=u.useState("login"),[m,v]=u.useState(!1),[S,V]=u.useState(!1),[x,h]=u.useState(!1),[,C]=R(),{user:i,isLoading:f,loginMutation:Y,registerMutation:H}=U();$.useEffect(()=>{if(i&&!f){const a=i.userType==="client"?"/client/dashboard":i.userType==="provider"?"/provider/dashboard":i.userType==="admin"?"/admin/dashboard":"/";C(a)}},[i,f,C]);const n=T({resolver:k(G),defaultValues:{email:"",password:""}}),t=T({resolver:k(W),defaultValues:{email:"",password:"",confirmPassword:"",name:"",phone:"",cpf:"",userType:"client"}});if(f)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#58c9d1]/5 to-[#58c9d1]/10 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-[#58c9d1] mx-auto mb-3"}),e.jsx("p",{className:"text-gray-700 text-sm",children:"Verificando autenticação..."})]})});if(i)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#58c9d1]/5 to-[#58c9d1]/10 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-[#58c9d1] mx-auto mb-3"}),e.jsx("p",{className:"text-gray-700 text-sm",children:"Redirecionando..."})]})});async function B(a){var b,p;h(!0);try{const s=await P("/api/login",{method:"POST",body:JSON.stringify(a)});if(s&&s.token){try{localStorage.setItem("authToken",s.token)}catch(r){console.error("❌ Erro ao salvar no localStorage:",r)}try{sessionStorage.setItem("authToken",s.token)}catch(r){console.error("❌ Erro ao salvar no sessionStorage:",r)}g({title:"Login realizado com sucesso!",description:`Bem-vindo(a) de volta, ${((b=s.user)==null?void 0:b.name)||((p=s.user)==null?void 0:p.email)}!`}),setTimeout(()=>{var r,c;((r=s.user)==null?void 0:r.userType)==="provider"?window.location.href="/provider/dashboard":((c=s.user)==null?void 0:c.userType)==="admin"?window.location.href="/admin/dashboard":window.location.href="/client/dashboard"},1e3)}else throw new Error("Token não encontrado na resposta da API")}catch(s){g({title:"Erro ao entrar",description:s.message||"Verifique seus dados.",variant:"destructive"})}finally{h(!1)}}async function D(a){h(!0);const{confirmPassword:b,...p}=a;try{const s=await P("/api/register",{method:"POST",body:JSON.stringify(p)});if(s&&s.token){try{localStorage.setItem("authToken",s.token)}catch(r){console.error("❌ Erro ao salvar no localStorage:",r)}try{sessionStorage.setItem("authToken",s.token)}catch(r){console.error("❌ Erro ao salvar no sessionStorage:",r)}g({title:"Conta criada com sucesso!",description:"Bem-vindo(a) ao AgendoAI!"}),setTimeout(()=>{var r,c;((r=s.user)==null?void 0:r.userType)==="provider"?window.location.href="/provider/dashboard":((c=s.user)==null?void 0:c.userType)==="admin"?window.location.href="/admin/dashboard":window.location.href="/client/dashboard"},1e3)}else throw new Error("Token não encontrado na resposta da API")}catch(s){g({title:"Erro ao cadastrar",description:s.message||"Verifique seus dados.",variant:"destructive"})}finally{h(!1)}}return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-[#58c9d1]/5 to-[#58c9d1]/10 p-3",children:[e.jsxs("div",{className:"mb-4 w-full max-w-sm text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2 text-gray-900",children:"AgendoAI"}),e.jsx("p",{className:"text-sm mb-3 text-gray-600",children:"Revolucione seus agendamentos com IA"}),e.jsxs("div",{className:"flex justify-center gap-2 mb-3 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1 bg-[#58c9d1]/20 text-[#58c9d1] px-2 py-1 rounded-full font-medium",children:[e.jsx(A,{className:"h-3 w-3"})," Agendamento inteligente"]}),e.jsxs("span",{className:"flex items-center gap-1 bg-[#58c9d1]/20 text-[#58c9d1] px-2 py-1 rounded-full font-medium",children:[e.jsx(I,{className:"h-3 w-3"})," Gestão de agenda"]})]})]}),e.jsxs("div",{className:"w-full max-w-sm bg-white/95 backdrop-blur-sm rounded-xl border border-[#58c9d1]/20 shadow-lg p-4",children:[e.jsx("img",{src:"/AgendoAilogo.png",alt:"AgendoAI Logo",className:"h-12 w-auto mx-auto mb-4",style:{maxWidth:100}}),e.jsxs("div",{className:"flex w-full mb-4",children:[e.jsx("button",{className:`flex-1 py-2 rounded-l-lg text-sm font-medium transition-all duration-200 ${d==="login"?"bg-[#58c9d1] text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,onClick:()=>N("login"),type:"button",children:"Entrar"}),e.jsx("button",{className:`flex-1 py-2 rounded-r-lg text-sm font-medium transition-all duration-200 ${d==="register"?"bg-[#58c9d1] text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,onClick:()=>N("register"),type:"button",children:"Cadastrar"})]}),d==="login"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1 text-center",children:"Bem-vindo de volta!"}),e.jsx("p",{className:"text-gray-600 mb-4 text-xs text-center",children:"Acesse sua conta para continuar"}),e.jsxs("form",{onSubmit:n.handleSubmit(B),className:"w-full space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(o,{type:"email",placeholder:"E-mail",...n.register("email"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",autoComplete:"email"}),e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),n.formState.errors.email&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:n.formState.errors.email.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{type:m?"text":"password",placeholder:"Senha",...n.register("password"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 pr-10 text-sm",autoComplete:"current-password"}),e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#58c9d1] hover:text-gray-700 transition-colors",onClick:()=>v(a=>!a),tabIndex:-1,children:m?e.jsx(w,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"})}),n.formState.errors.password&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:n.formState.errors.password.message})]}),e.jsx(E,{type:"submit",className:"w-full h-10 mt-2 bg-[#58c9d1] text-white font-medium shadow-md hover:bg-[#58c9d1]/90 transition-all",disabled:x,children:x?e.jsxs("span",{className:"flex items-center gap-2 justify-center text-sm",children:[e.jsx("span",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Entrando..."]}):"Entrar"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1 text-center",children:"Crie sua conta"}),e.jsx("p",{className:"text-gray-600 mb-4 text-xs text-center",children:"Desbloqueie benefícios exclusivos!"}),e.jsxs("form",{onSubmit:t.handleSubmit(D),className:"w-full space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(o,{type:"email",placeholder:"E-mail",...t.register("email"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",autoComplete:"email"}),e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),t.formState.errors.email&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:t.formState.errors.email.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{type:"text",placeholder:"Nome",...t.register("name"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",autoComplete:"name"}),e.jsx(F,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),t.formState.errors.name&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:t.formState.errors.name.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{type:m?"text":"password",placeholder:"Senha",...t.register("password"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 pr-10 text-sm",autoComplete:"new-password"}),e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#58c9d1] hover:text-gray-700 transition-colors",onClick:()=>v(a=>!a),tabIndex:-1,children:m?e.jsx(w,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"})}),t.formState.errors.password&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:t.formState.errors.password.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{type:S?"text":"password",placeholder:"Confirmar senha",...t.register("confirmPassword"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 pr-10 text-sm",autoComplete:"new-password"}),e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#58c9d1] hover:text-gray-700 transition-colors",onClick:()=>V(a=>!a),tabIndex:-1,children:S?e.jsx(w,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"})}),t.formState.errors.confirmPassword&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:t.formState.errors.confirmPassword.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{type:"text",placeholder:"Telefone (DDD + número)",...t.register("phone"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",autoComplete:"tel",maxLength:15,inputMode:"numeric"}),e.jsx(F,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),t.formState.errors.phone&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:t.formState.errors.phone.message})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:`flex-1 py-2 rounded-lg text-xs font-medium border transition-all duration-200 ${t.watch("userType")==="client"?"border-[#58c9d1] bg-[#58c9d1] text-white shadow-md":"border-gray-300 bg-white text-gray-600 hover:bg-gray-50"}`,onClick:()=>t.setValue("userType","client"),children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(J,{className:"h-3 w-3"})," Cliente"]})}),e.jsx("button",{type:"button",className:`flex-1 py-2 rounded-lg text-xs font-medium border transition-all duration-200 ${t.watch("userType")==="provider"?"border-[#58c9d1] bg-[#58c9d1] text-white shadow-md":"border-gray-300 bg-white text-gray-600 hover:bg-gray-50"}`,onClick:()=>t.setValue("userType","provider"),children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(I,{className:"h-3 w-3"})," Prestador"]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{type:"text",placeholder:"CPF",...t.register("cpf"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",maxLength:18,autoComplete:"cpf"}),e.jsx(z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),t.formState.errors.cpf&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:t.formState.errors.cpf.message})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["Ao continuar, você concorda com os ",e.jsx("span",{className:"underline cursor-pointer",children:"Termos do Serviço"})," e o ",e.jsx("span",{className:"underline cursor-pointer",children:"Aviso de Privacidade"}),"."]}),e.jsx(E,{type:"submit",className:"w-full h-10 mt-2 bg-[#58c9d1] text-white font-medium shadow-md hover:bg-[#58c9d1]/90 transition-all",disabled:x,children:x?e.jsxs("span",{className:"flex items-center gap-2 justify-center text-sm",children:[e.jsx("span",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Criando conta..."]}):e.jsxs("span",{className:"flex items-center gap-2 justify-center text-sm",children:["Criar conta ",e.jsx(A,{className:"h-3 w-3"})]})})]})]}),e.jsxs("div",{className:"w-full text-center mt-4 text-xs text-gray-400 font-medium",children:["© ",new Date().getFullYear()," AgendoAI. Todos os direitos reservados."]})]})]})}export{ie as default};
