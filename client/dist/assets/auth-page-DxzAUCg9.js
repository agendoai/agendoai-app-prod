import{j as e}from"./ui-UIpCtT3r.js";import{r as u,a as V}from"./vendor-vA4cx1mx.js";import{u as k,t as C,o as D,s as n,e as $}from"./zod-BPPSwYm9.js";import{u as G}from"./router-CxXythJb.js";import{I as l}from"./input-CNw_l4dQ.js";import{B as E}from"./button-BvsVcTDx.js";import{j as q,u as z,k as A,t as f}from"./index-BJ9Cw0LR.js";import{C as I}from"./circle-check-big-KcM-m8FQ.js";import{C as P}from"./calendar-tibBNAR3.js";import{M as L}from"./mail-CWCa77eK.js";import{L as y}from"./lock-IdjQRp-S.js";import{E as w}from"./eye-off-D02LmxDM.js";import{E as j}from"./eye-B-pO_WB7.js";import{U as R}from"./user-C2y4PfJ8.js";import{U as J}from"./users-ZhvK7Ip9.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=q("IdCard",[["path",{d:"M16 10h2",key:"8sgtl7"}],["path",{d:"M16 14h2",key:"epxaof"}],["path",{d:"M6.17 15a3 3 0 0 1 5.66 0",key:"n6f512"}],["circle",{cx:"9",cy:"11",r:"2",key:"yxgjnd"}],["rect",{x:"2",y:"5",width:"20",height:"14",rx:"2",key:"qneu4z"}]]),W=D({email:n().email({message:"Email invÃ¡lido"}),password:n().min(6,{message:"Senha deve ter pelo menos 6 caracteres"})}),Y=D({email:n().email({message:"Email invÃ¡lido"}),password:n().min(6,{message:"Senha deve ter pelo menos 6 caracteres"}),confirmPassword:n(),name:n().min(1,{message:"Nome Ã© obrigatÃ³rio"}),phone:n().min(10,{message:"Telefone Ã© obrigatÃ³rio"}).regex(/^\d{10,15}$/,{message:"Telefone invÃ¡lido"}),cpf:n().min(11,{message:"CPF Ã© obrigatÃ³rio"}),userType:$(["client","provider"])}).refine(d=>d.password===d.confirmPassword,{message:"As senhas nÃ£o conferem",path:["confirmPassword"]});function ce(){console.log("ðŸ”µ ===== AUTH PAGE CARREGADA ====="),console.log("ðŸŒ URL atual:",window.location.href),console.log("ðŸ”§ NODE_ENV:","production");const[d,N]=u.useState("login"),[m,v]=u.useState(!1),[S,M]=u.useState(!1),[x,h]=u.useState(!1),[,T]=G(),{user:a,isLoading:g,loginMutation:F,registerMutation:O}=z();console.log("ðŸ” Hook useAuth carregado:",{user:a?{id:a.id,email:a.email}:null,isLoading:g,hasLoginMutation:!!F,hasRegisterMutation:!!O}),V.useEffect(()=>{if(a&&!g){const r=a.userType==="client"?"/client/dashboard":a.userType==="provider"?"/provider/dashboard":a.userType==="admin"?"/admin/dashboard":"/";T(r)}},[a,g,T]);const i=k({resolver:C(W),defaultValues:{email:"",password:""}}),s=k({resolver:C(Y),defaultValues:{email:"",password:"",confirmPassword:"",name:"",phone:"",cpf:"",userType:"client"}});if(g)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#58c9d1]/5 to-[#58c9d1]/10 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-[#58c9d1] mx-auto mb-3"}),e.jsx("p",{className:"text-gray-700 text-sm",children:"Verificando autenticaÃ§Ã£o..."})]})});if(a)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#58c9d1]/5 to-[#58c9d1]/10 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-[#58c9d1] mx-auto mb-3"}),e.jsx("p",{className:"text-gray-700 text-sm",children:"Redirecionando..."})]})});async function B(r){var b,p;console.log("ðŸ”µ ===== LOGIN SUBMIT DIRETO ====="),console.log("ðŸ“¤ Dados do formulÃ¡rio:",{email:r.email,password:"***"}),h(!0);try{console.log("ðŸš€ Fazendo login direto via API...");const t=await A("/api/login",{method:"POST",body:JSON.stringify(r)});if(console.log("âœ… Login bem-sucedido!"),console.log("ðŸ‘¤ Resposta da API:",t),t&&t.token){console.log("ðŸ”‘ Salvando token diretamente...");try{localStorage.setItem("authToken",t.token),console.log("âœ… Token salvo no localStorage")}catch(o){console.error("âŒ Erro ao salvar no localStorage:",o)}try{sessionStorage.setItem("authToken",t.token),console.log("âœ… Token salvo no sessionStorage")}catch(o){console.error("âŒ Erro ao salvar no sessionStorage:",o)}f({title:"Login realizado com sucesso!",description:`Bem-vindo(a) de volta, ${((b=t.user)==null?void 0:b.name)||((p=t.user)==null?void 0:p.email)}!`}),setTimeout(()=>{var o,c;((o=t.user)==null?void 0:o.userType)==="provider"?window.location.href="/provider/dashboard":((c=t.user)==null?void 0:c.userType)==="admin"?window.location.href="/admin/dashboard":window.location.href="/client/dashboard"},1e3)}else throw console.error("âŒ Token nÃ£o encontrado na resposta"),new Error("Token nÃ£o encontrado na resposta da API")}catch(t){console.error("âŒ Erro no login direto:",t),f({title:"Erro ao entrar",description:t.message||"Verifique seus dados.",variant:"destructive"})}finally{h(!1)}}async function U(r){console.log("ðŸ”µ ===== REGISTRO SUBMIT DIRETO ====="),console.log("ðŸ“¤ Dados do formulÃ¡rio:",{email:r.email,name:r.name}),h(!0);const{confirmPassword:b,...p}=r;try{console.log("ðŸš€ Fazendo registro direto via API...");const t=await A("/api/register",{method:"POST",body:JSON.stringify(p)});if(console.log("âœ… Registro bem-sucedido!"),console.log("ðŸ‘¤ Resposta da API:",t),t&&t.token){console.log("ðŸ”‘ Salvando token diretamente...");try{localStorage.setItem("authToken",t.token),console.log("âœ… Token salvo no localStorage")}catch(o){console.error("âŒ Erro ao salvar no localStorage:",o)}try{sessionStorage.setItem("authToken",t.token),console.log("âœ… Token salvo no sessionStorage")}catch(o){console.error("âŒ Erro ao salvar no sessionStorage:",o)}f({title:"Conta criada com sucesso!",description:"Bem-vindo(a) ao AgendoAI!"}),setTimeout(()=>{var o,c;((o=t.user)==null?void 0:o.userType)==="provider"?window.location.href="/provider/dashboard":((c=t.user)==null?void 0:c.userType)==="admin"?window.location.href="/admin/dashboard":window.location.href="/client/dashboard"},1e3)}else throw console.error("âŒ Token nÃ£o encontrado na resposta"),new Error("Token nÃ£o encontrado na resposta da API")}catch(t){console.error("âŒ Erro no registro direto:",t),f({title:"Erro ao cadastrar",description:t.message||"Verifique seus dados.",variant:"destructive"})}finally{h(!1)}}return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-[#58c9d1]/5 to-[#58c9d1]/10 p-3",children:[e.jsxs("div",{className:"mb-4 w-full max-w-sm text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2 text-gray-900",children:"AgendoAI"}),e.jsx("p",{className:"text-sm mb-3 text-gray-600",children:"Revolucione seus agendamentos com IA"}),e.jsxs("div",{className:"flex justify-center gap-2 mb-3 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1 bg-[#58c9d1]/20 text-[#58c9d1] px-2 py-1 rounded-full font-medium",children:[e.jsx(I,{className:"h-3 w-3"})," Agendamento inteligente"]}),e.jsxs("span",{className:"flex items-center gap-1 bg-[#58c9d1]/20 text-[#58c9d1] px-2 py-1 rounded-full font-medium",children:[e.jsx(P,{className:"h-3 w-3"})," GestÃ£o de agenda"]})]})]}),e.jsxs("div",{className:"w-full max-w-sm bg-white/95 backdrop-blur-sm rounded-xl border border-[#58c9d1]/20 shadow-lg p-4",children:[e.jsx("img",{src:"/AgendoAilogo.png",alt:"AgendoAI Logo",className:"h-12 w-auto mx-auto mb-4",style:{maxWidth:100}}),e.jsxs("div",{className:"flex w-full mb-4",children:[e.jsx("button",{className:`flex-1 py-2 rounded-l-lg text-sm font-medium transition-all duration-200 ${d==="login"?"bg-[#58c9d1] text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,onClick:()=>N("login"),type:"button",children:"Entrar"}),e.jsx("button",{className:`flex-1 py-2 rounded-r-lg text-sm font-medium transition-all duration-200 ${d==="register"?"bg-[#58c9d1] text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,onClick:()=>N("register"),type:"button",children:"Cadastrar"})]}),d==="login"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1 text-center",children:"Bem-vindo de volta!"}),e.jsx("p",{className:"text-gray-600 mb-4 text-xs text-center",children:"Acesse sua conta para continuar"}),e.jsxs("form",{onSubmit:i.handleSubmit(B),className:"w-full space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:"email",placeholder:"E-mail",...i.register("email"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",autoComplete:"email"}),e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),i.formState.errors.email&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:i.formState.errors.email.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:m?"text":"password",placeholder:"Senha",...i.register("password"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 pr-10 text-sm",autoComplete:"current-password"}),e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#58c9d1] hover:text-gray-700 transition-colors",onClick:()=>v(r=>!r),tabIndex:-1,children:m?e.jsx(w,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"})}),i.formState.errors.password&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:i.formState.errors.password.message})]}),e.jsx(E,{type:"submit",className:"w-full h-10 mt-2 bg-[#58c9d1] text-white font-medium shadow-md hover:bg-[#58c9d1]/90 transition-all",disabled:x,children:x?e.jsxs("span",{className:"flex items-center gap-2 justify-center text-sm",children:[e.jsx("span",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Entrando..."]}):"Entrar"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1 text-center",children:"Crie sua conta"}),e.jsx("p",{className:"text-gray-600 mb-4 text-xs text-center",children:"Desbloqueie benefÃ­cios exclusivos!"}),e.jsxs("form",{onSubmit:s.handleSubmit(U),className:"w-full space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:"email",placeholder:"E-mail",...s.register("email"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",autoComplete:"email"}),e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),s.formState.errors.email&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:s.formState.errors.email.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:"text",placeholder:"Nome",...s.register("name"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",autoComplete:"name"}),e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),s.formState.errors.name&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:s.formState.errors.name.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:m?"text":"password",placeholder:"Senha",...s.register("password"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 pr-10 text-sm",autoComplete:"new-password"}),e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#58c9d1] hover:text-gray-700 transition-colors",onClick:()=>v(r=>!r),tabIndex:-1,children:m?e.jsx(w,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"})}),s.formState.errors.password&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:s.formState.errors.password.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:S?"text":"password",placeholder:"Confirmar senha",...s.register("confirmPassword"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 pr-10 text-sm",autoComplete:"new-password"}),e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#58c9d1] hover:text-gray-700 transition-colors",onClick:()=>M(r=>!r),tabIndex:-1,children:S?e.jsx(w,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"})}),s.formState.errors.confirmPassword&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:s.formState.errors.confirmPassword.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:"text",placeholder:"Telefone (DDD + nÃºmero)",...s.register("phone"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",autoComplete:"tel",maxLength:15,inputMode:"numeric"}),e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),s.formState.errors.phone&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:s.formState.errors.phone.message})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:`flex-1 py-2 rounded-lg text-xs font-medium border transition-all duration-200 ${s.watch("userType")==="client"?"border-[#58c9d1] bg-[#58c9d1] text-white shadow-md":"border-gray-300 bg-white text-gray-600 hover:bg-gray-50"}`,onClick:()=>s.setValue("userType","client"),children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(J,{className:"h-3 w-3"})," Cliente"]})}),e.jsx("button",{type:"button",className:`flex-1 py-2 rounded-lg text-xs font-medium border transition-all duration-200 ${s.watch("userType")==="provider"?"border-[#58c9d1] bg-[#58c9d1] text-white shadow-md":"border-gray-300 bg-white text-gray-600 hover:bg-gray-50"}`,onClick:()=>s.setValue("userType","provider"),children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(P,{className:"h-3 w-3"})," Prestador"]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{type:"text",placeholder:"CPF",...s.register("cpf"),className:"h-10 bg-white border border-[#58c9d1]/30 rounded-lg text-gray-900 placeholder:text-gray-500 focus:border-[#58c9d1] pl-10 text-sm",maxLength:18,autoComplete:"cpf"}),e.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#58c9d1] h-4 w-4"}),s.formState.errors.cpf&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:s.formState.errors.cpf.message})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["Ao continuar, vocÃª concorda com os ",e.jsx("span",{className:"underline cursor-pointer",children:"Termos do ServiÃ§o"})," e o ",e.jsx("span",{className:"underline cursor-pointer",children:"Aviso de Privacidade"}),"."]}),e.jsx(E,{type:"submit",className:"w-full h-10 mt-2 bg-[#58c9d1] text-white font-medium shadow-md hover:bg-[#58c9d1]/90 transition-all",disabled:x,children:x?e.jsxs("span",{className:"flex items-center gap-2 justify-center text-sm",children:[e.jsx("span",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Criando conta..."]}):e.jsxs("span",{className:"flex items-center gap-2 justify-center text-sm",children:["Criar conta ",e.jsx(I,{className:"h-3 w-3"})]})})]})]}),e.jsxs("div",{className:"w-full text-center mt-4 text-xs text-gray-400 font-medium",children:["Â© ",new Date().getFullYear()," AgendoAI. Todos os direitos reservados."]})]})]})}export{ce as default};
