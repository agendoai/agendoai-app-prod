import{j as e}from"./ui-UIpCtT3r.js";import{r as N}from"./vendor-vA4cx1mx.js";import{j as A,b as k,c as u,B as t,o as $,C as B,d as S,e as P,f as D,g as M,h as R,n as x}from"./index-C8-zpcKL.js";import{u as F}from"./router-CxXythJb.js";import{C as h}from"./client-layout-DkJA58XK.js";import{B as L}from"./badge-DP5DyHeb.js";import{A as T}from"./arrow-left-DbtXU75N.js";import{C as O}from"./check-yFju7Kvd.js";import{U as q}from"./user-CXc1AnQW.js";import{C as V}from"./calendar-CEG0wbcY.js";import{M as H}from"./map-pin-DhYkN1aN.js";import{P as U}from"./phone-C8roGb90.js";import{C as W}from"./clock-53JnXU7l.js";import{D as z}from"./download-DigfM2HL.js";import{A as K}from"./arrow-right-CQewGx4Y.js";import{p as _}from"./parseISO-C4T3oArM.js";import{f as G}from"./format-CGvBu07F.js";import{p as Q}from"./pt-BR-Cxqo7XV3.js";import"./navbar-vyjn30u5.js";import"./proxy-B2Nma8Bt.js";import"./search-ChrBAPJG.js";import"./calendar-check-B0nV5Uhw.js";import"./en-US-xSPtgCq_.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=A("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);function we(){const[,l]=F(),{toast:p}=k(),[g]=N.useState(typeof window<"u"?new URLSearchParams(window.location.search):new URLSearchParams),n=g.get("appointmentId"),d=n?parseInt(n):null,m=d&&!isNaN(d)&&d>0;N.useEffect(()=>{if(n&&!m){console.error(`ID de agendamento inválido: ${n}`);const r=setTimeout(()=>{p({title:"ID de agendamento inválido",description:"Redirecionando para seus agendamentos...",variant:"destructive"}),l("/client/appointments")},2e3);return()=>clearTimeout(r)}},[n,m,l,p]);const f=()=>{l("/client/appointments")},{data:s,isLoading:y,error:j}=u({queryKey:["/api/appointments",d],queryFn:()=>(console.log(`Buscando dados do agendamento: ${d}`),x(`/appointments/${d}`).then(r=>{if(!r.ok)throw console.error(`Erro ao buscar agendamento: ${r.status}`),new Error(`Erro ao buscar agendamento: ${r.status}`);return r.json()}).then(r=>(console.log("Dados do agendamento:",r),r)).catch(r=>{throw console.error("Erro ao buscar dados do agendamento:",r),r})),enabled:m,retry:3,refetchOnWindowFocus:!1}),{data:o,error:J}=u({queryKey:["/api/services",s==null?void 0:s.serviceId],queryFn:()=>(console.log(`Buscando dados do serviço para sucesso: ${s==null?void 0:s.serviceId}`),x(`/services/${s==null?void 0:s.serviceId}`).then(r=>{if(!r.ok)throw console.error(`Erro ao buscar serviço: ${r.status}`),new Error(`Erro ao buscar serviço: ${r.status}`);return r.json()}).then(r=>(console.log("Dados do serviço para sucesso:",r),r)).catch(r=>{throw console.error("Erro ao buscar dados do serviço:",r),r})),enabled:!!(s!=null&&s.serviceId),retry:3,refetchOnWindowFocus:!1}),{data:c,error:Y}=u({queryKey:["/api/providers",s==null?void 0:s.providerId],queryFn:()=>(console.log(`Buscando dados do prestador para sucesso: ${s==null?void 0:s.providerId}`),x(`/providers/${s==null?void 0:s.providerId}`).then(r=>{if(!r.ok)throw console.error(`Erro ao buscar prestador: ${r.status}`),new Error(`Erro ao buscar prestador: ${r.status}`);return r.json()}).then(r=>(console.log("Dados do prestador para sucesso:",r),r)).catch(r=>{throw console.error("Erro ao buscar dados do prestador:",r),r})),enabled:!!(s!=null&&s.providerId),retry:3,refetchOnWindowFocus:!1});if(y)return e.jsx(h,{children:e.jsx("div",{className:"container py-8",children:e.jsx("div",{className:"flex justify-center items-center min-h-[50vh]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})})});if(!s||!o||!(c!=null&&c.user))return e.jsx(h,{children:e.jsx("div",{className:"container py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-destructive",children:"Agendamento não encontrado"}),e.jsx("p",{className:"text-muted-foreground",children:s?o?"Não foi possível encontrar informações do prestador para este agendamento.":"Não foi possível encontrar informações do serviço para este agendamento.":`Não foi possível encontrar o agendamento #${n}. O agendamento pode ter sido cancelado ou o ID informado é inválido.`}),j&&e.jsxs("p",{className:"text-sm text-destructive",children:["Erro: ",j.message]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsx(t,{onClick:f,children:"Ver Meus Agendamentos"}),e.jsx(t,{variant:"outline",onClick:()=>window.location.reload(),children:"Tentar Novamente"})]})]})})});const i=c.user,a=c.settings,v=()=>{try{const r=typeof s.date=="string"?_(s.date):s.date;return G(r,"EEEE, dd 'de' MMMM 'de' yyyy",{locale:Q})}catch(r){return console.error("Erro ao formatar data:",r),typeof s.date=="string"?s.date:String(s.date)}},w=()=>{const r={pending:{label:"Pendente",variant:"secondary"},confirmed:{label:"Confirmado",variant:"default"},cancelled:{label:"Cancelado",variant:"destructive"},completed:{label:"Concluído",variant:"default"},no_show:{label:"Não Compareceu",variant:"destructive"}},{label:I,variant:E}=r[s.status]||{label:s.status,variant:"outline"};return e.jsx(L,{variant:E,children:I})},b=()=>({money:"Dinheiro",credit_card:"Cartão de Crédito/Débito",pix:"PIX",stripe:"Cartão Online (Stripe)",asaas:"Pagamento Online (Asaas)"})[s.paymentMethod]||s.paymentMethod,C=()=>{const r=v();`${o.name}${i.name}${r}${s.startTime}${s.endTime}${new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.totalPrice/100)}`};return e.jsxs(e.Fragment,{children:[e.jsx($,{children:e.jsx("title",{children:"Agendamento Confirmado | AgendoAI"})}),e.jsx(h,{children:e.jsxs("div",{className:"container py-6 max-w-4xl",children:[e.jsx("div",{className:"flex items-center mb-6",children:e.jsxs(t,{variant:"ghost",onClick:()=>window.history.back(),className:"mr-4 flex items-center",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Voltar"]})}),e.jsxs("div",{className:"text-center mb-8 space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"rounded-full bg-primary/10 w-20 h-20 flex items-center justify-center",children:e.jsx(O,{className:"h-10 w-10 text-primary"})})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Agendamento Realizado com Sucesso!"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Seu agendamento foi registrado e está aguardando confirmação do prestador. Você receberá notificações sobre atualizações."})]}),e.jsxs(B,{className:"mb-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(P,{children:"Detalhes do Agendamento"}),w()]}),e.jsxs(D,{children:["Código: #",s.id]})]}),e.jsx(M,{className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{className:"h-5 w-5 mt-0.5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Prestador"}),e.jsx("p",{className:"text-muted-foreground",children:i.name}),(a==null?void 0:a.businessName)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a.businessName})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(V,{className:"h-5 w-5 mt-0.5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Data e Horário"}),e.jsx("p",{className:"text-muted-foreground capitalize",children:v()}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.startTime," - ",s.endTime]})]})]}),((a==null?void 0:a.address)||i.address)&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{className:"h-5 w-5 mt-0.5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Local"}),e.jsx("p",{className:"text-muted-foreground",children:(a==null?void 0:a.address)||i.address})]})]}),i.phone&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(U,{className:"h-5 w-5 mt-0.5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Telefone"}),e.jsx("p",{className:"text-muted-foreground",children:i.phone})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"rounded-lg bg-secondary p-4",children:[e.jsx("h3",{className:"font-medium mb-3",children:"Serviço"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:o.name}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[e.jsx(W,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[o.duration," minutos"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-medium",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o.price/100)})})]}),e.jsx("div",{className:"border-t border-border pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Taxa de serviço"}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format((s.totalPrice-o.price)/100)})]})}),e.jsx("div",{className:"border-t border-border pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Forma de pagamento"}),e.jsx("span",{children:b()})]})}),e.jsx("div",{className:"border-t border-border pt-3",children:e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.totalPrice/100)})]})})]})]}),s.notes&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-medium mb-1",children:"Observações"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-line",children:s.notes})]})]})]})}),e.jsxs(R,{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(t,{variant:"outline",className:"w-full sm:w-auto",onClick:C,children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Compartilhar via WhatsApp"]}),e.jsxs(t,{variant:"outline",className:"w-full sm:w-auto",onClick:()=>window.print(),children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Salvar Comprovante"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(t,{onClick:f,className:"w-full sm:w-auto",children:["Ver Meus Agendamentos",e.jsx(K,{className:"ml-2 h-4 w-4"})]}),e.jsx(t,{variant:"outline",className:"w-full sm:w-auto",onClick:()=>l("/client/new-booking"),children:"Agendar Outro Serviço"})]})]})})]})}export{we as default};
