import{j as e}from"./ui-UIpCtT3r.js";import{r as g}from"./vendor-vA4cx1mx.js";import{j as E,b as k,c as x,H as $,C as B,d as S,e as P,f as D,g as M,h as R,n as h}from"./index-DEm1NP11.js";import{u as F}from"./router-CxXythJb.js";import{C as p}from"./client-layout-CcG18RG7.js";import{B as t}from"./button-j6LGAhsQ.js";import{B as L}from"./badge-B2JTkC27.js";import{s as T}from"./whatsapp-CXCPK3xh.js";import{A as O}from"./arrow-left-BNqHqGt7.js";import{C as q}from"./check-BuvXqBRH.js";import{U as V}from"./user-DI19obd1.js";import{C as H}from"./calendar-eMUANn8Q.js";import{M as W}from"./map-pin-DRgDManj.js";import{P as U}from"./phone-CGR7ixWb.js";import{C as z}from"./clock-CLU1zMjH.js";import{D as K}from"./download-CansyATS.js";import{A as _}from"./arrow-right-Dwuaz0ii.js";import{p as G}from"./parseISO-C4T3oArM.js";import{f as Q}from"./format-CGvBu07F.js";import{p as X}from"./pt-BR-Cxqo7XV3.js";import"./navbar-hjdp4XdK.js";import"./proxy-B8DL77xD.js";import"./house-CfLQCnfM.js";import"./search-C7LrDLVs.js";import"./calendar-check-6xqeojHy.js";import"./en-US-xSPtgCq_.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=E("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);function Ae(){const[,l]=F(),{toast:f}=k(),[y]=g.useState(typeof window<"u"?new URLSearchParams(window.location.search):new URLSearchParams),n=y.get("appointmentId"),d=n?parseInt(n):null,m=d&&!isNaN(d)&&d>0;g.useEffect(()=>{if(n&&!m){console.error(`ID de agendamento inv√°lido: ${n}`);const r=setTimeout(()=>{f({title:"ID de agendamento inv√°lido",description:"Redirecionando para seus agendamentos...",variant:"destructive"}),l("/client/appointments")},2e3);return()=>clearTimeout(r)}},[n,m,l,f]);const j=()=>{l("/client/appointments")},{data:s,isLoading:w,error:v}=x({queryKey:["/api/appointments",d],queryFn:()=>(console.log(`Buscando dados do agendamento: ${d}`),h(`/appointments/${d}`).then(r=>{if(!r.ok)throw console.error(`Erro ao buscar agendamento: ${r.status}`),new Error(`Erro ao buscar agendamento: ${r.status}`);return r.json()}).then(r=>(console.log("Dados do agendamento:",r),r)).catch(r=>{throw console.error("Erro ao buscar dados do agendamento:",r),r})),enabled:m,retry:3,refetchOnWindowFocus:!1}),{data:o,error:Y}=x({queryKey:["/api/services",s==null?void 0:s.serviceId],queryFn:()=>(console.log(`Buscando dados do servi√ßo para sucesso: ${s==null?void 0:s.serviceId}`),h(`/services/${s==null?void 0:s.serviceId}`).then(r=>{if(!r.ok)throw console.error(`Erro ao buscar servi√ßo: ${r.status}`),new Error(`Erro ao buscar servi√ßo: ${r.status}`);return r.json()}).then(r=>(console.log("Dados do servi√ßo para sucesso:",r),r)).catch(r=>{throw console.error("Erro ao buscar dados do servi√ßo:",r),r})),enabled:!!(s!=null&&s.serviceId),retry:3,refetchOnWindowFocus:!1}),{data:c,error:Z}=x({queryKey:["/api/providers",s==null?void 0:s.providerId],queryFn:()=>(console.log(`Buscando dados do prestador para sucesso: ${s==null?void 0:s.providerId}`),h(`/providers/${s==null?void 0:s.providerId}`).then(r=>{if(!r.ok)throw console.error(`Erro ao buscar prestador: ${r.status}`),new Error(`Erro ao buscar prestador: ${r.status}`);return r.json()}).then(r=>(console.log("Dados do prestador para sucesso:",r),r)).catch(r=>{throw console.error("Erro ao buscar dados do prestador:",r),r})),enabled:!!(s!=null&&s.providerId),retry:3,refetchOnWindowFocus:!1});if(w)return e.jsx(p,{children:e.jsx("div",{className:"container py-8",children:e.jsx("div",{className:"flex justify-center items-center min-h-[50vh]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})})});if(!s||!o||!(c!=null&&c.user))return e.jsx(p,{children:e.jsx("div",{className:"container py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-destructive",children:"Agendamento n√£o encontrado"}),e.jsx("p",{className:"text-muted-foreground",children:s?o?"N√£o foi poss√≠vel encontrar informa√ß√µes do prestador para este agendamento.":"N√£o foi poss√≠vel encontrar informa√ß√µes do servi√ßo para este agendamento.":`N√£o foi poss√≠vel encontrar o agendamento #${n}. O agendamento pode ter sido cancelado ou o ID informado √© inv√°lido.`}),v&&e.jsxs("p",{className:"text-sm text-destructive",children:["Erro: ",v.message]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsx(t,{onClick:j,children:"Ver Meus Agendamentos"}),e.jsx(t,{variant:"outline",onClick:()=>window.location.reload(),children:"Tentar Novamente"})]})]})})});const i=c.user,a=c.settings,N=()=>{try{const r=typeof s.date=="string"?G(s.date):s.date;return Q(r,"EEEE, dd 'de' MMMM 'de' yyyy",{locale:X})}catch(r){return console.error("Erro ao formatar data:",r),typeof s.date=="string"?s.date:String(s.date)}},b=()=>{const r={pending:{label:"Pendente",variant:"secondary"},confirmed:{label:"Confirmado",variant:"default"},cancelled:{label:"Cancelado",variant:"destructive"},completed:{label:"Conclu√≠do",variant:"default"},no_show:{label:"N√£o Compareceu",variant:"destructive"}},{label:u,variant:A}=r[s.status]||{label:s.status,variant:"outline"};return e.jsx(L,{variant:A,children:u})},C=()=>({money:"Dinheiro",credit_card:"Cart√£o de Cr√©dito/D√©bito",pix:"PIX",stripe:"Cart√£o Online (Stripe)",asaas:"Pagamento Online (Asaas)"})[s.paymentMethod]||s.paymentMethod,I=()=>{const r=N(),u=`üóìÔ∏è *Agendamento confirmado* üóìÔ∏è

Servi√ßo: ${o.name}
Prestador: ${i.name}
Data: ${r}
Hor√°rio: ${s.startTime} - ${s.endTime}

Valor: ${new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.totalPrice/100)}

Agendado via AgendoAI`;T(u)};return e.jsxs(e.Fragment,{children:[e.jsx($,{children:e.jsx("title",{children:"Agendamento Confirmado | AgendoAI"})}),e.jsx(p,{children:e.jsxs("div",{className:"container py-6 max-w-4xl",children:[e.jsx("div",{className:"flex items-center mb-6",children:e.jsxs(t,{variant:"ghost",onClick:()=>window.history.back(),className:"mr-4 flex items-center",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Voltar"]})}),e.jsxs("div",{className:"text-center mb-8 space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"rounded-full bg-primary/10 w-20 h-20 flex items-center justify-center",children:e.jsx(q,{className:"h-10 w-10 text-primary"})})}),e.jsx("h1",{className:"text-3xl font-bold",children:"Agendamento Realizado com Sucesso!"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Seu agendamento foi registrado e est√° aguardando confirma√ß√£o do prestador. Voc√™ receber√° notifica√ß√µes sobre atualiza√ß√µes."})]}),e.jsxs(B,{className:"mb-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(P,{children:"Detalhes do Agendamento"}),b()]}),e.jsxs(D,{children:["C√≥digo: #",s.id]})]}),e.jsx(M,{className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(V,{className:"h-5 w-5 mt-0.5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Prestador"}),e.jsx("p",{className:"text-muted-foreground",children:i.name}),(a==null?void 0:a.businessName)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a.businessName})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{className:"h-5 w-5 mt-0.5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Data e Hor√°rio"}),e.jsx("p",{className:"text-muted-foreground capitalize",children:N()}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.startTime," - ",s.endTime]})]})]}),((a==null?void 0:a.address)||i.address)&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(W,{className:"h-5 w-5 mt-0.5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Local"}),e.jsx("p",{className:"text-muted-foreground",children:(a==null?void 0:a.address)||i.address})]})]}),i.phone&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(U,{className:"h-5 w-5 mt-0.5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Telefone"}),e.jsx("p",{className:"text-muted-foreground",children:i.phone})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"rounded-lg bg-secondary p-4",children:[e.jsx("h3",{className:"font-medium mb-3",children:"Servi√ßo"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:o.name}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[o.duration," minutos"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-medium",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o.price/100)})})]}),e.jsx("div",{className:"border-t border-border pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Taxa de servi√ßo"}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format((s.totalPrice-o.price)/100)})]})}),e.jsx("div",{className:"border-t border-border pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Forma de pagamento"}),e.jsx("span",{children:C()})]})}),e.jsx("div",{className:"border-t border-border pt-3",children:e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.totalPrice/100)})]})})]})]}),s.notes&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-medium mb-1",children:"Observa√ß√µes"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-line",children:s.notes})]})]})]})}),e.jsxs(R,{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(t,{variant:"outline",className:"w-full sm:w-auto",onClick:I,children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Compartilhar via WhatsApp"]}),e.jsxs(t,{variant:"outline",className:"w-full sm:w-auto",onClick:()=>window.print(),children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Salvar Comprovante"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(t,{onClick:j,className:"w-full sm:w-auto",children:["Ver Meus Agendamentos",e.jsx(_,{className:"ml-2 h-4 w-4"})]}),e.jsx(t,{variant:"outline",className:"w-full sm:w-auto",onClick:()=>l("/client/new-booking"),children:"Agendar Outro Servi√ßo"})]})]})})]})}export{Ae as default};
