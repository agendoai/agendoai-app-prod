import{j as e}from"./ui-UIpCtT3r.js";import{r as m}from"./vendor-vA4cx1mx.js";import{c as E,B as p,L as V,t as D,X as z}from"./index-DyNThJGx.js";import{u as I}from"./router-CxXythJb.js";import{T as M,a as O,b as L,c as R}from"./tabs-DxyIPEUL.js";import{B as x}from"./badge-8936XTFZ.js";import{I as Q}from"./input-Cpt0D0t5.js";import{S as q,a as G,b as H,c as K,d as c}from"./select-U8nqgpyh.js";import{P as X,a as _,b as J}from"./popover-CdbiayGx.js";import{C as U}from"./calendar-BeTNI8-t.js";import{N as W}from"./navbar-KiPP5LKi.js";import{S as Y}from"./search-7vo4URqD.js";import{C as Z}from"./calendar-range-OrX3juQb.js";import{R as ee}from"./refresh-ccw-Dma_Ow_m.js";import{C as $}from"./calendar-CqpYA11m.js";import{C as N}from"./circle-check-CYUXpZhf.js";import{C as B}from"./clock-Cy7Y6FGJ.js";import{f as te}from"./format-CGvBu07F.js";import{p as se}from"./pt-BR-Cxqo7XV3.js";import"./index-BdQq_4o_.js";import"./index-BH3L9zMK.js";import"./chevron-down-DiXfwTNR.js";import"./check-l4wqyeDa.js";import"./en-US-xSPtgCq_.js";import"./endOfMonth-CH6FLORf.js";import"./isSameDay-BJjwZdUf.js";import"./addDays-BQ37Zmqx.js";import"./subDays-K6OA95hK.js";import"./chevron-right-DM1GZBJV.js";import"./chevron-left-BADql8Jf.js";import"./proxy-DTNweHv3.js";import"./calendar-check-CFgGdJAu.js";import"./user-CHl9goRc.js";const re=t=>{const n=t.filter(r=>r.status==="pending"),o=t.filter(r=>r.status==="executing"),a=t.filter(r=>r.status==="confirmed"||r.status==="confirmado"),u=t.filter(r=>r.status==="canceled"),i=t.filter(r=>r.status==="no-show");return{upcoming:n,pending:n,executing:o,completed:a,canceled:u,noShow:i}},ae=({status:t})=>{if(!t)return null;let n="outline",o=t,a="";switch(t){case"confirmed":case"confirmado":n="default",o="Confirmado",a="bg-green-100 text-green-800 border-green-200";break;case"pending":n="secondary",o="Pendente",a="bg-yellow-100 text-yellow-800 border-yellow-200";break;case"executing":n="outline",o="Executando",a="bg-blue-100 text-blue-800 border-blue-200";break;case"completed":n="outline",o="Concluído",a="bg-cyan-100 text-cyan-800 border-cyan-200";break;case"canceled":n="destructive",o="Cancelado",a="bg-red-100 text-red-800 border-red-200";break;case"no-show":n="outline",o="Não Compareceu",a="bg-orange-100 text-orange-800 border-orange-200";break;default:n="outline"}return e.jsx(x,{variant:n,className:a,children:o})},ne=({status:t})=>!t||t==="pending"||t==="aguardando_pagamento"?e.jsx(x,{variant:"warning",className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"Aguardando pagamento"}):t==="confirmado"||t==="paid"?e.jsx(x,{variant:"success",className:"bg-green-100 text-green-800 border-green-200",children:"Pago"}):t==="failed"?e.jsx(x,{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200",children:"Pagamento falhou"}):t==="refunded"?e.jsx(x,{variant:"info",className:"bg-blue-100 text-blue-800 border-blue-200",children:"Pagamento reembolsado"}):e.jsx(x,{variant:"outline",children:t});function Ve(){const[,t]=I(),[n,o]=m.useState("overview"),[a,u]=m.useState(null),[i,h]=m.useState(""),[r,b]=m.useState(void 0),[w,C]=m.useState(!1),{data:g=[],isLoading:S,refetch:v,isRefetching:k}=E({queryKey:["/api/client/appointments"],staleTime:30*1e3,enabled:!!localStorage.getItem("authToken")}),F=async()=>{C(!0);try{await v(),D({title:"Agendamentos atualizados",description:"Lista de agendamentos atualizada com sucesso"})}catch{D({title:"Erro ao atualizar",description:"Não foi possível atualizar os agendamentos",variant:"destructive"})}finally{C(!1)}};m.useEffect(()=>{(async()=>{const l=document.referrer;l&&(l.includes("/client/new-booking")||l.includes("/client/booking-confirmation"))&&await v()})()},[v]);const d=re(g),j=g==null?void 0:g.filter(s=>{if(r){const l=new Date(s.date),f=new Date(r);if(l.toDateString()!==f.toDateString())return!1}if(a){if(a==="confirmed"){if(s.status!=="confirmed"&&s.status!=="confirmado")return!1}else if(s.status!==a)return!1}if(i){const l=i.toLowerCase(),f=(s.providerName||"").toLowerCase(),A=(s.serviceName||"").toLowerCase();return f.includes(l)||A.includes(l)}return!0}).sort((s,l)=>{const f=new Date(`${s.date}T${s.startTime}`);return new Date(`${l.date}T${l.startTime}`).getTime()-f.getTime()}),T=j.filter(s=>s.status==="pending"||s.status==="confirmed"||s.status==="confirmado"||s.status==="executing"),P=j.filter(s=>s.status==="canceled"||s.status==="no-show");return e.jsxs("div",{className:"min-h-screen w-full bg-white pb-24 flex justify-center items-start",children:[e.jsxs("div",{className:"w-full max-w-md mx-auto px-2 sm:px-0",children:[e.jsxs("header",{className:"flex flex-col items-center justify-center pt-6 pb-2 relative",children:[e.jsx("img",{src:"/AgendoAilogo.png",alt:"AgendoAI Logo",className:"h-12 w-auto mb-1 drop-shadow-2xl"}),e.jsx("h1",{className:"text-xl sm:text-2xl font-extrabold text-cyan-700 text-center mb-2 mt-1 tracking-tight drop-shadow-sm",children:"Meus Agendamentos"})]}),e.jsxs("div",{className:"pt-1 pb-4 space-y-5",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("h2",{className:"text-[1.1rem] font-bold mb-2 text-neutral-900 border-l-4 border-cyan-400 pl-2 tracking-wide",children:"Resumo"}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-1",children:[e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-white border border-cyan-200 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-sm sm:text-lg font-bold text-cyan-700",children:d.upcoming.length}),e.jsx("div",{className:"text-[8px] sm:text-[10px] text-cyan-600 font-medium",children:"Próximos"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white border border-blue-200 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-sm sm:text-lg font-bold text-blue-700",children:d.executing.length}),e.jsx("div",{className:"text-[8px] sm:text-[10px] text-blue-600 font-medium",children:"Executando"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-white border border-green-200 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-sm sm:text-lg font-bold text-green-700",children:d.completed.length}),e.jsx("div",{className:"text-[8px] sm:text-[10px] text-green-600 font-medium",children:"Concluídos"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-white border border-yellow-200 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-sm sm:text-lg font-bold text-yellow-700",children:d.pending.length}),e.jsx("div",{className:"text-[8px] sm:text-[10px] text-yellow-600 font-medium",children:"Pendentes"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-white border border-red-200 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-sm sm:text-lg font-bold text-red-700",children:d.canceled.length}),e.jsx("div",{className:"text-[8px] sm:text-[10px] text-red-600 font-medium",children:"Cancelados"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-white border border-orange-200 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-sm sm:text-lg font-bold text-orange-700",children:d.noShow.length}),e.jsx("div",{className:"text-[8px] sm:text-[10px] text-orange-600 font-medium",children:"Não Compareceu"})]})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("h2",{className:"text-[1.1rem] font-bold mb-2 text-neutral-900 border-l-4 border-cyan-400 pl-2 tracking-wide",children:"Filtros"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:"search",placeholder:"Buscar por prestador ou serviço...",className:"pl-10 rounded-full bg-gray-50 border border-gray-200 shadow-sm focus:border-cyan-400 focus:ring-2 focus:ring-cyan-100 py-2 text-sm",value:i,onChange:s=>h(s.target.value)})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(q,{value:a||"todos",onValueChange:s=>u(s==="todos"?null:s),children:[e.jsx(G,{className:"flex-1 rounded-full bg-gray-50 border border-gray-200 shadow-sm focus:border-cyan-400 focus:ring-2 focus:ring-cyan-100 text-sm",children:e.jsx(H,{placeholder:"Status"})}),e.jsxs(K,{className:"bg-white",children:[e.jsx(c,{value:"todos",children:"Todos"}),e.jsx(c,{value:"pending",children:"Pendentes"}),e.jsx(c,{value:"executing",children:"Executando"}),e.jsx(c,{value:"confirmed",children:"Confirmados"}),e.jsx(c,{value:"completed",children:"Concluídos"}),e.jsx(c,{value:"canceled",children:"Cancelados"}),e.jsx(c,{value:"no-show",children:"Não Compareceu"})]})]}),e.jsxs(X,{children:[e.jsx(_,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"gap-2 rounded-full bg-gray-50 border border-gray-200 shadow-sm focus:border-cyan-400 focus:ring-2 focus:ring-cyan-100 text-sm",children:[e.jsx(Z,{className:"h-4 w-4"}),r?te(r,"dd/MM"):"Data"]})}),e.jsxs(J,{className:"w-auto p-0 bg-white",align:"end",children:[e.jsx(U,{mode:"single",selected:r,onSelect:b,locale:se,initialFocus:!0}),r&&e.jsx("div",{className:"p-3 border-t border-border flex justify-end",children:e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>b(void 0),children:"Limpar"})})]})]}),e.jsx(p,{variant:"outline",onClick:F,disabled:S||k||w,className:"gap-2 rounded-full bg-gray-50 border border-gray-200 shadow-sm focus:border-cyan-400 focus:ring-2 focus:ring-cyan-100 text-sm",children:e.jsx(ee,{className:`h-4 w-4 ${k||w?"animate-spin":""}`})})]})]})]}),S?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(V,{className:"h-8 w-8 animate-spin text-cyan-500"})}):g.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx($,{className:"h-16 w-16 text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum agendamento encontrado"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Você ainda não possui agendamentos."}),e.jsxs(p,{onClick:()=>t("/client/new-booking"),className:"gap-2 bg-gradient-to-r from-cyan-400 via-teal-400 to-emerald-400",children:[e.jsx($,{className:"h-4 w-4"}),"Fazer primeiro agendamento"]})]})}):e.jsxs("div",{className:"mb-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("h2",{className:"text-[1.1rem] font-bold text-neutral-900 border-l-4 border-cyan-400 pl-2 tracking-wide",children:"Agendamentos"})}),e.jsxs(M,{value:n,onValueChange:o,className:"w-full",children:[e.jsxs(O,{className:"grid w-full grid-cols-2 mb-4",children:[e.jsx(L,{value:"overview",className:"text-xs",children:"Visão Geral"}),e.jsx(L,{value:"list",className:"text-xs",children:"Lista"})]}),e.jsxs(R,{value:"overview",className:"mt-0",children:[e.jsx("div",{className:"space-y-2",children:T.length>0?T.slice(0,6).map(s=>e.jsx(y,{appointment:s},s.id)):e.jsx("div",{className:"flex flex-col items-center py-4 text-neutral-400 text-sm",children:"Nenhum agendamento próximo."})}),P.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h2",{className:"font-bold text-red-700 text-base tracking-wide",children:"Cancelados"}),e.jsx("div",{className:"space-y-2",children:P.map(s=>e.jsx(y,{appointment:s,hidePaymentStatus:!0},s.id))})]})]}),e.jsx(R,{value:"list",className:"mt-0",children:e.jsx("div",{className:"space-y-2",children:j.length>0?j.map(s=>e.jsx(y,{appointment:s},s.id)):e.jsx("div",{className:"flex flex-col items-center py-4 text-neutral-400 text-sm",children:"Nenhum agendamento encontrado com os filtros aplicados."})})})]})]})]})]}),e.jsx(W,{})]})}function y({appointment:t,hidePaymentStatus:n}){const[,o]=I(),a=()=>{o(`/client/appointments/${t.id}`)},u=r=>{switch(r){case"confirmed":case"confirmado":return"bg-green-50";case"pending":return"bg-yellow-50";case"executing":return"bg-blue-50";case"completed":return"bg-cyan-50";case"canceled":return"bg-red-50";case"no-show":return"bg-orange-50";default:return"bg-cyan-50"}},i=r=>{switch(r){case"confirmed":case"confirmado":return e.jsx(N,{className:"text-green-400",size:22});case"pending":return e.jsx(B,{className:"text-yellow-500",size:22});case"executing":return e.jsx(B,{className:"text-blue-500",size:22});case"completed":return e.jsx(N,{className:"text-cyan-400",size:22});case"canceled":return e.jsx(z,{className:"text-red-400",size:22});case"no-show":return e.jsx(z,{className:"text-orange-400",size:22});default:return e.jsx(N,{className:"text-cyan-400",size:22})}},h=r=>r==null?"N/A":`R$ ${(r/100).toFixed(2).replace(".",",")}`;return e.jsxs("div",{className:`flex items-start bg-gradient-to-br from-white to-gray-50 border border-gray-100 rounded-2xl shadow p-4 mb-4 hover:shadow-lg transition-all duration-150 cursor-pointer ${{pending:"min-h-[4.5rem]",default:"min-h-[3.5rem]"}[t.status]}`,onClick:a,style:{boxShadow:"0 2px 8px 0 rgba(0,0,0,0.04)"},children:[e.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full mr-3 mt-1 ${u(t.status)}`,children:i(t.status)}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col",children:[e.jsx("div",{className:"font-semibold text-[1rem] text-neutral-900 truncate leading-tight mb-1",children:t.serviceName||`Serviço #${t.serviceId}`}),e.jsxs("div",{className:"text-xs text-cyan-700 font-medium leading-tight mb-0.5",children:[t.startTime," - ",t.endTime,(()=>{const r=new Date().toISOString().split("T")[0],b=new Date(Date.now()+24*60*60*1e3).toISOString().split("T")[0];return t.date===r?" • Hoje":t.date===b?" • Amanhã":""})()]}),e.jsx("div",{className:"text-xs text-neutral-400 truncate leading-tight mb-0.5",children:t.providerName||`Prestador #${t.providerId}`}),e.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[e.jsx("span",{className:"text-xs font-medium text-neutral-700 flex items-center gap-1",children:e.jsx(ae,{status:t.status})}),!n&&e.jsx("span",{className:"text-xs font-medium text-neutral-700 flex items-center gap-1",children:e.jsx(ne,{status:t.paymentStatus})})]}),t.totalPrice&&t.totalPrice>0&&e.jsx("div",{className:"text-xs text-neutral-600 font-medium leading-tight mt-1",children:h(t.totalPrice)}),e.jsxs("div",{className:"flex flex-row gap-2 mt-3 justify-end",children:[e.jsx("button",{className:"px-4 py-1.5 text-xs rounded-full bg-gray-100 text-cyan-700 font-semibold shadow-sm hover:bg-cyan-100 hover:shadow-md transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-cyan-200",onClick:r=>{r.stopPropagation(),a()},children:"Ver"}),(t.status==="pending"||t.status==="confirmed"||t.status==="confirmado")&&e.jsx("button",{className:"px-4 py-1.5 text-xs rounded-full bg-red-100 text-red-700 font-semibold shadow-sm hover:bg-red-200 hover:shadow-md transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-red-200",onClick:r=>{r.stopPropagation(),alert("Funcionalidade de cancelamento em breve!")},children:"Cancelar"})]})]})]})}export{Ve as default};
