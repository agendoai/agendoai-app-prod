import{s as k,u as z,a as E,c as F,b as I,r as j,d as P,j as e,C as h,f as v,i as g,X as D,g as q,h as A,k as L}from"./index-DOe1OCu1.js";import{u as B}from"./useMutation-Lmj9MX3Y.js";import{B as m}from"./button-C168b4m4.js";import{I as u}from"./input-BHH75Tpk.js";import{L as x}from"./label-MMklymaS.js";import{S as o}from"./skeleton-B-0dSqkR.js";import{N as $,C as H}from"./navbar-DlESdVVP.js";import{m as N}from"./proxy-Ct5X7xz4.js";import{A as M}from"./arrow-left-BPt4aJQo.js";import{S as Q}from"./scissors-BLALsYWu.js";import{D as R}from"./dollar-sign-D5ikk9cU.js";import{C as U}from"./clock-CVsS3BCD.js";import{A as K}from"./activity-XrmxzlUx.js";import{C as O}from"./calendar-Mn3IWFfL.js";import{S as V}from"./save-C3GtLHVl.js";import{H as J}from"./house-Calz6FJi.js";import{C as X}from"./calendar-check-CY2XiYKN.js";import{S as G}from"./search-Bjz8DxPP.js";import{U as W}from"./user-BQOYdOBU.js";function ge(){const{id:y}=k(),{user:p}=z(),[,l]=E(),{toast:f}=F(),w=I(),i=parseInt(y||"0"),[s,n]=j.useState({price:"",duration:"",executionTime:"",breakTime:""});console.log("EditServicePage renderizando, ID:",i);const{data:a,isLoading:C,error:b}=P({queryKey:["/api/provider-services",i],queryFn:async()=>{console.log("Fazendo requisição para:",`/api/provider-services/${i}`);const r=await fetch(`/api/provider-services/${i}`);if(!r.ok)throw new Error("Erro ao carregar serviço");const t=await r.json();return console.log("Dados do serviço recebidos:",t),t},enabled:!!i});j.useEffect(()=>{var r,t,d;a&&n({price:a.price?(a.price/100).toString():"",duration:((r=a.duration)==null?void 0:r.toString())||"",executionTime:((t=a.executionTime)==null?void 0:t.toString())||"",breakTime:((d=a.breakTime)==null?void 0:d.toString())||""})},[a]);const c=B({mutationFn:async r=>{const t=await fetch(`/api/provider-services/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!t.ok){const d=await t.json();throw new Error(d.error||"Falha ao atualizar o serviço")}return t.json()},onSuccess:()=>{w.invalidateQueries({queryKey:[`/api/provider-services/provider/${p==null?void 0:p.id}`]}),f({title:"Serviço atualizado",description:"O serviço foi atualizado com sucesso.",variant:"default"}),l("/provider/services")},onError:r=>{f({title:"Erro ao atualizar serviço",description:r.message||"Falha ao atualizar o serviço",variant:"destructive"})}}),S=r=>{r.preventDefault();const t={price:Math.round(parseFloat(s.price)*100),duration:parseInt(s.duration),executionTime:parseInt(s.executionTime),breakTime:parseInt(s.breakTime)};console.log("Enviando dados para atualização:",t),c.mutate(t)},T=r=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r/100);return C?e.jsx("div",{className:"min-h-screen bg-gray-50 pb-20",children:e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-2xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(o,{className:"h-8 w-64 mb-4"}),e.jsx(o,{className:"h-4 w-96"})]}),e.jsxs(h,{className:"border-0 shadow-lg bg-white",children:[e.jsxs(v,{children:[e.jsx(o,{className:"h-6 w-48 mb-2"}),e.jsx(o,{className:"h-4 w-64"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsx(o,{className:"h-12 w-full rounded-lg"}),e.jsx(o,{className:"h-12 w-full rounded-lg"}),e.jsx(o,{className:"h-12 w-full rounded-lg"}),e.jsx(o,{className:"h-12 w-full rounded-lg"})]})]})]})}):b?e.jsx("div",{className:"min-h-screen bg-gray-50 pb-20",children:e.jsx("div",{className:"container mx-auto py-8 px-4 max-w-2xl",children:e.jsx(h,{className:"border-0 shadow-lg bg-white",children:e.jsxs(g,{className:"p-8 text-center",children:[e.jsx("div",{className:"text-red-500 mb-6",children:e.jsx(D,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold mb-3 text-gray-800",children:"Erro ao carregar serviço"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Não foi possível carregar as informações do serviço."}),e.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Erro: ",b.message]}),e.jsx(m,{onClick:()=>l("/provider/services"),className:"bg-[#58c9d1] hover:bg-[#58c9d1]/90 text-white shadow-lg",children:"Voltar para Serviços"})]})})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-2xl",children:[e.jsxs(N.div,{className:"mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>l("/provider/services"),className:"hover:bg-gray-100 transition-all duration-200 rounded-lg",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Voltar"]}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Editar Serviço"})]}),e.jsx("p",{className:"text-gray-600 text-base",children:"Personalize as configurações do seu serviço."})]}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:e.jsxs(h,{className:"border-0 shadow-lg bg-white",children:[e.jsxs(v,{className:"pb-6",children:[e.jsxs(q,{className:"flex items-center gap-3 text-xl",children:[e.jsx("div",{className:"p-2 bg-[#58c9d1] rounded-lg",children:e.jsx(Q,{className:"h-5 w-5 text-white"})}),(a==null?void 0:a.name)||(a==null?void 0:a.serviceName)]}),e.jsx(A,{className:"text-gray-600",children:(a==null?void 0:a.description)||"Sem descrição"})]}),e.jsxs("form",{onSubmit:S,children:[e.jsxs(g,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{htmlFor:"price",className:"text-sm font-semibold text-gray-700",children:"Preço do Serviço"}),e.jsxs("div",{className:"relative group",children:[e.jsx(R,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#58c9d1] transition-colors"}),e.jsx(u,{id:"price",type:"number",step:"0.01",min:"0",value:s.price,onChange:r=>n({...s,price:r.target.value}),placeholder:"0.00",className:"pl-12 h-12 text-lg font-medium border-2 border-gray-200 focus:border-[#58c9d1] focus:ring-4 focus:ring-[#58c9d1]/20 rounded-lg transition-all duration-200 hover:border-gray-300",required:!0})]}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-[#58c9d1] rounded-full"}),"Preço atual: ",a!=null&&a.price?T(a.price):"Não definido"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{htmlFor:"duration",className:"text-sm font-semibold text-gray-700",children:"Duração Total (minutos)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(U,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#58c9d1] transition-colors"}),e.jsx(u,{id:"duration",type:"number",min:"1",value:s.duration,onChange:r=>n({...s,duration:r.target.value}),placeholder:"30",className:"pl-12 h-12 text-lg font-medium border-2 border-gray-200 focus:border-[#58c9d1] focus:ring-4 focus:ring-[#58c9d1]/20 rounded-lg transition-all duration-200 hover:border-gray-300",required:!0})]}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-[#58c9d1] rounded-full"}),"Duração atual: ",(a==null?void 0:a.duration)||30," minutos"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{htmlFor:"executionTime",className:"text-sm font-semibold text-gray-700",children:"Tempo de Execução (minutos)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(K,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#58c9d1] transition-colors"}),e.jsx(u,{id:"executionTime",type:"number",min:"1",value:s.executionTime,onChange:r=>n({...s,executionTime:r.target.value}),placeholder:"25",className:"pl-12 h-12 text-lg font-medium border-2 border-gray-200 focus:border-[#58c9d1] focus:ring-4 focus:ring-[#58c9d1]/20 rounded-lg transition-all duration-200 hover:border-gray-300",required:!0})]}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-[#58c9d1] rounded-full"}),"Tempo de execução atual: ",(a==null?void 0:a.executionTime)||25," minutos"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{htmlFor:"breakTime",className:"text-sm font-semibold text-gray-700",children:"Tempo de Intervalo (minutos)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(O,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#58c9d1] transition-colors"}),e.jsx(u,{id:"breakTime",type:"number",min:"0",value:s.breakTime,onChange:r=>n({...s,breakTime:r.target.value}),placeholder:"5",className:"pl-12 h-12 text-lg font-medium border-2 border-gray-200 focus:border-[#58c9d1] focus:ring-4 focus:ring-[#58c9d1]/20 rounded-lg transition-all duration-200 hover:border-gray-300"})]}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-[#58c9d1] rounded-full"}),"Intervalo atual: ",(a==null?void 0:a.breakTime)||5," minutos"]})]})]}),e.jsxs(L,{className:"flex justify-between pt-6",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>l("/provider/services"),disabled:c.isPending,className:"h-12 px-6 rounded-lg border-2 hover:bg-gray-50 transition-all duration-200",children:"Cancelar"}),e.jsx(m,{type:"submit",disabled:c.isPending,className:"h-12 px-8 bg-[#58c9d1] hover:bg-[#58c9d1]/90 text-white shadow-lg rounded-lg transition-all duration-200 hover:shadow-xl",children:c.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-5 w-5 mr-2"}),"Salvar Alterações"]})})]})]})]})})]}),e.jsx($,{items:[{icon:e.jsx(J,{size:26}),label:"Início",href:"/provider/dashboard"},{icon:e.jsx(X,{size:26}),label:"Agenda",href:"/provider/schedule"},{icon:e.jsx(H,{size:32,className:"animate-pulse"}),label:"Novo",href:"/provider/manual-booking"},{icon:e.jsx(G,{size:26}),label:"Buscar",href:"/provider/search"},{icon:e.jsx(W,{size:26}),label:"Perfil",href:"/provider/profile"}]})]})}export{ge as default};
