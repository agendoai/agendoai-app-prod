import{j as e}from"./ui-UIpCtT3r.js";import{b as Ke,u as Ve,n as S,c as A,G,B as E,H as Je,p as We}from"./index-DMVSlINz.js";import{C as Qe}from"./client-layout-DcnrflWl.js";import{r as c,a as Ue}from"./vendor-vA4cx1mx.js";import{u as be}from"./router-CxXythJb.js";import{C as Xe}from"./calendar-CjSP4W6P.js";import{C as Ge}from"./chevron-left-D3HQY9r6.js";import{C as N}from"./check-pZ3JKVe2.js";import{C as R}from"./chevron-right-D0P32XR-.js";import{S as Y}from"./sparkles-DGT_Y2m5.js";import{C as Ye,H as Ze}from"./heart-aeFvtixR.js";import{S as et}from"./scissors-BXZIrokt.js";import{f as je}from"./format-CGvBu07F.js";import{p as pe}from"./pt-BR-Cxqo7XV3.js";import"./navbar-5CcLqczq.js";import"./proxy-CAhTMUof.js";import"./search-0bFur5DB.js";import"./calendar-check-DBfSly3E.js";import"./user-DxXpbN3a.js";import"./en-US-xSPtgCq_.js";import"./endOfMonth-CH6FLORf.js";import"./isSameDay-BJjwZdUf.js";import"./addDays-BQ37Zmqx.js";import"./subDays-K6OA95hK.js";function tt({onComplete:Z,preSelectedServiceId:$=null}){const{toast:B}=Ke(),{user:C}=Ve(),[,H]=be(),[a,v]=c.useState("niche"),[j,D]=c.useState(null),[p,ee]=c.useState(null),[l,te]=c.useState($?[$]:[]),[x,se]=c.useState(null),[d,ae]=c.useState(null),[m,re]=c.useState(null),[L,ie]=c.useState(null),[n,le]=c.useState(null),[F,ve]=c.useState(0),[O,Ne]=c.useState(0),[P,K]=c.useState({}),[ne,V]=c.useState({}),[oe,de]=c.useState(null),[J,ye]=c.useState([]),[z,ce]=c.useState(!1),[y,st]=c.useState(null),[we,W]=c.useState(!1);Ue.useEffect(()=>{if(!d||!x||a!=="time-slot")return;(async()=>{ce(!0);try{const s=oe||F||30,o=`/api/providers/${d}/time-slots?date=${x.toISOString().split("T")[0]}&duration=${s}`,r=await(await fetch(o)).json();ye(Array.isArray(r)?r:r.timeSlots||[])}catch(s){console.error("Erro ao buscar hor√°rios:",s)}finally{ce(!1)}})()},[d,x,oe,F,a]),c.useEffect(()=>{$&&S(`/services/${$}`).then(t=>t.json()).then(t=>{t&&t.categoryId&&(ee(t.categoryId),S(`/categories/${t.categoryId}`).then(s=>s.json()).then(s=>{s&&s.nicheId&&D(s.nicheId)}))})},[$]);const{data:Q,isLoading:me}=A({queryKey:["/api/niches"],staleTime:6e4}),{data:U,isLoading:xe}=A({queryKey:["/api/niches",j,"categories"],queryFn:()=>j?S(`/niches/${j}/categories`).then(t=>t.json()):null,enabled:!!j,staleTime:6e4}),{data:w,isLoading:X}=A({queryKey:["/api/services",p],queryFn:()=>p?S(`/services?categoryId=${p}`).then(t=>t.json()):null,enabled:!!p,staleTime:6e4});c.useEffect(()=>{},[l,x]);const{data:f,isLoading:M}=A({queryKey:["/api/providers",l,x],queryFn:async()=>l.length===0||!x?[]:(l[0],((await(await fetch(`/api/providers/service-search?serviceIds=${l.join(",")}&date=${x.toISOString().split("T")[0]}`)).json()).providers||[]).map(r=>r.provider?r.provider:r)),enabled:l.length>0&&!!x,staleTime:6e4});c.useEffect(()=>{if(f&&f.length>0&&l.length>0&&x){const t={};let s=0;const o=f.filter(i=>i&&i.id).length;if(o===0)return;f.forEach(i=>{if(!i||!i.id){s++;return}V(r=>({...r,[i.id]:!0})),S(`/provider-services/provider/${i.id}`).then(r=>{if(!r.ok)throw new Error(`Erro ao buscar servi√ßos: ${r.status}`);return r.json()}).then(r=>{const h=Array.isArray(r)?r.filter(g=>g&&g.serviceId&&l.includes(g.serviceId)).map(g=>({id:g.serviceId,name:g.serviceName||"Servi√ßo",duration:g.executionTime||g.defaultDuration||30,price:g.price||0})):[];let u=0;h&&h.length>0&&h.forEach(g=>{const He=parseInt(g.duration)||0;u+=He});const b=u>0?u:F||60;return S(`/providers/${i.id}/time-slots?date=${x.toISOString().split("T")[0]}&duration=${b}`).then(g=>g.json()).then(g=>(Array.isArray(g)&&g.length>0&&(t[i.id]=h),{hasSlots:Array.isArray(g)&&g.length>0,provider:i,services:h}))}).then(({hasSlots:r,provider:h,services:u})=>{r&&K(b=>({...b,[h.id]:u})),V(b=>({...b,[h.id]:!1})),s++,s===o&&(f.filter(b=>t[b.id]),K({...t}))}).catch(r=>{V(h=>({...h,[i.id]:!1})),s++})})}},[f,l,x,F]);const he=c.useCallback(async(t,s)=>{if(!t||!s)return null;try{const o=await S(`/provider-services/provider/${t}/service/${s}`);if(!o.ok)return null;const i=await o.json();return i.executionTime||i.duration||null}catch{return null}},[]);c.useEffect(()=>{async function t(){if(d&&l.length===1){const s=await he(d,l[0]);de(s)}else de(null)}t()},[d,l,he]),c.useEffect(()=>{a==="service"&&l.length>0&&v("date"),se(null),ae(null),re(null),K({})},[l]);const T=()=>{const t=["niche","category","service","date","providers","time-slot","payment","confirmation"],s=t.indexOf(a);s<t.length-1&&v(t[s+1])},Se=()=>{const t=["niche","category","service","date","providers","time-slot","payment","confirmation"],s=t.indexOf(a);s>0&&v(t[s-1])},$e=t=>{D(t),T()},Ce=t=>{ee(t),te([]),T()},ge=t=>{const s=l.includes(t);let o;s?o=l.filter(i=>i!==t):o=[t],te(o)},Te=t=>{se(t),T()},Ie=(t,s,o)=>{ae(t),s!==void 0&&ve(s),o!==void 0&&Ne(o),T()},Pe=t=>{re(t)},ke=t=>{ie(t),le(null)},q=t=>{le(t)},Ee=async()=>{var o;if(l.length===0||!d||!x||!m||!L||!n){B({title:"Erro ao finalizar agendamento",description:"Por favor, preencha todas as informa√ß√µes necess√°rias.",variant:"destructive"});return}const t=(k==null?void 0:k.fixedFee)||0,s=O+t;if(n==="pix"||n==="credit_card"||n==="debit_card"){const i={providerId:d,serviceId:l[0],date:x.toISOString().split("T")[0],startTime:m.startTime,endTime:m.endTime,totalPrice:s,paymentMethod:n,...l.length>1&&{multipleServices:!0,serviceIds:l,services:l.map(r=>{const h=(P[d]||[]).find(u=>u.id===r);return{serviceId:r,duration:(h==null?void 0:h.duration)||30}})}};sessionStorage.setItem("pendingBookingData",JSON.stringify(i)),H(`/client/payment?amount=${s}&paymentMethod=${n}`);return}try{const i=(w==null?void 0:w.filter(u=>l.includes(u.id)))||[],r=f==null?void 0:f.find(u=>u.id===d);let h;if(l.length===1?h=await fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({providerId:d,serviceId:l[0],date:x.toISOString().split("T")[0],startTime:m.startTime,paymentMethod:n,totalPrice:s,paymentStatus:"pending",serviceName:((o=i[0])==null?void 0:o.name)||"Servi√ßo",clientName:(C==null?void 0:C.name)||"Cliente"})}):h=await fetch("/api/booking/consecutive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({providerId:d,date:x.toISOString().split("T")[0],startTime:m.startTime,paymentMethod:n,totalPrice:s,paymentStatus:"pending",serviceName:i.map(u=>u.name).join(", "),clientName:(C==null?void 0:C.name)||"Cliente",services:l.map(u=>{const b=(P[d]||[]).find(g=>g.id===u);return{serviceId:u,duration:(b==null?void 0:b.duration)||30}})})}),!h.ok){const u=await h.json();throw new Error(u.error||"Erro ao criar agendamento")}v("confirmation")}catch(i){B({title:"Erro ao criar agendamento",description:i.message||"Tente novamente.",variant:"destructive"})}},De=t=>{const s=P[t]||[];let o=0,i=0;return s.filter(r=>l.includes(r.id)).forEach(r=>{o+=r.duration||0,i+=r.price||0}),{duration:o,price:i}},{data:k,isLoading:I}=A({queryKey:["/api/provider-fees",d],queryFn:async()=>{if(!d)return null;const t=await S(`/provider-fees/${d}`);return t.ok?await t.json():null},enabled:!!d});function ue(t){switch(t==null?void 0:t.toLowerCase()){case"beleza":return e.jsx(et,{className:"h-10 w-10"});case"sa√∫de":return e.jsx(Ze,{className:"h-10 w-10"});case"automotivo":return e.jsx(Ye,{className:"h-10 w-10"});case"casa":return e.jsx(Je,{className:"h-10 w-10"});default:return e.jsx(Y,{className:"h-10 w-10"})}}function Le(t){return ue(t)}function fe(t,s=!1){return s?e.jsx(Y,{className:"h-8 w-8"}):e.jsx(Y,{className:"h-10 w-10"})}const Fe=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üéØ"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha sua √°rea"}),e.jsx("p",{className:"text-gray-600",children:"Selecione a categoria que melhor atende sua necessidade"})]}),me?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(G,{})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:Q==null?void 0:Q.map(t=>e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${j===t.id?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>$e(t.id),disabled:me,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`text-2xl transition-transform group-hover:scale-110 ${j===t.id?"text-white":"text-teal-500"}`,children:ue(t.name)}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`font-semibold text-lg ${j===t.id?"text-white":"text-gray-800"}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 ${j===t.id?"text-white/80":"text-gray-500"}`,children:"Servi√ßos especializados"})]})]}),j===t.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]},t.id))})]}),Me=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üìÇ"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Selecione a categoria"}),e.jsx("p",{className:"text-gray-600",children:"Escolha o tipo de servi√ßo que voc√™ precisa"})]}),xe?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(G,{})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:U==null?void 0:U.map(t=>e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${p===t.id?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>Ce(t.id),disabled:xe,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`text-2xl transition-transform group-hover:scale-110 ${p===t.id?"text-white":"text-teal-500"}`,children:Le(t.name)}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`font-semibold text-lg ${p===t.id?"text-white":"text-gray-800"}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 ${p===t.id?"text-white/80":"text-gray-500"}`,children:"Servi√ßos dispon√≠veis"})]})]}),p===t.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]},t.id))})]}),Ae=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üõ†Ô∏è"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha seus servi√ßos"}),e.jsx("p",{className:"text-gray-600",children:"Selecione um ou mais servi√ßos que voc√™ precisa"})]}),X?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(G,{})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:w==null?void 0:w.map(t=>e.jsxs("div",{className:`group relative overflow-hidden rounded-xl transition-all duration-300 transform hover:scale-[1.01] ${l.includes(t.id)?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>{X||ge(t.id)},style:{cursor:X?"not-allowed":"pointer"},children:[e.jsx("div",{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx("div",{className:`w-8 h-8 sm:w-12 sm:h-12 rounded-full flex items-center justify-center transition-transform group-hover:scale-105 ${l.includes(t.id)?"bg-white/20":"bg-teal-100"}`,children:e.jsx("span",{className:"text-lg sm:text-xl",children:fe(t.name,!0)})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-base sm:text-lg ${l.includes(t.id)?"text-white":"text-gray-800"}`,children:t.name}),e.jsx("p",{className:`text-xs sm:text-sm mt-1 ${l.includes(t.id)?"text-white/80":"text-gray-600"}`,children:t.description.length>40?`${t.description.substring(0,40)}...`:t.description})]})]}),e.jsx("div",{className:"text-right"})]})}),l.includes(t.id)&&e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3",children:e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})})})]},t.id))})]}),Oe=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üìÖ"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha a data"}),e.jsx("p",{className:"text-gray-600",children:"Selecione quando voc√™ gostaria de agendar"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-200",children:e.jsx(Xe,{mode:"single",selected:x,onSelect:Te,disabled:t=>{const s=new Date;return s.setHours(0,0,0,0),t<s},className:"rounded-xl"})})}),x&&e.jsx("div",{className:"pt-6",children:e.jsxs(E,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:T,disabled:M,children:["Ver Prestadores ",e.jsx(R,{className:"ml-2 h-5 w-5"})]})})]}),ze=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üë•"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha o prestador"}),e.jsx("p",{className:"text-gray-600",children:"Selecione quem ir√° realizar seu servi√ßo"})]}),M?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-6",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Buscando prestadores..."}),e.jsx("p",{className:"text-gray-600",children:"Carregando profissionais dispon√≠veis para sua data"})]}):f&&f.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:f.map((t,s)=>{const o=De(t.id),i=ne[t.id];return e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${d===t.id?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"} ${i?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{!i&&!M&&Ie(t.id,o.duration,o.price)},disabled:i||M,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center transition-transform group-hover:scale-110 ${d===t.id?"bg-white/20":"bg-teal-100"}`,children:e.jsx("span",{className:"text-lg",children:"üë§"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${d===t.id?"text-white":"text-gray-800"}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 ${d===t.id?"text-white/80":"text-gray-600"}`,children:i?"Carregando servi√ßos...":"Prestador dispon√≠vel"})]})]}),e.jsxs("div",{className:"text-right",children:[P[t.id]&&P[t.id].length>0&&P[t.id].map((r,h)=>e.jsx("div",{className:"text-sm font-semibold text-neutral-800",children:`${r.name} - R$ ${(Number(r.price)/100).toFixed(2).replace(".",",")}`},r.id)),e.jsxs("div",{className:`text-sm ${d===t.id?"text-white/70":"text-gray-500"}`,children:[o.duration," min"]})]})]}),d===t.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]},t.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üòî"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Nenhum prestador dispon√≠vel para esta data."})]}),d&&e.jsx("div",{className:"pt-6",children:e.jsxs(E,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:T,disabled:ne[d]||M,children:["Escolher Hor√°rio ",e.jsx(R,{className:"ml-2 h-5 w-5"})]})})]}),qe=()=>!d||!x?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-yellow-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"‚ö†Ô∏è"})}),e.jsx("p",{className:"text-yellow-800 font-semibold",children:"Dados insuficientes para buscar hor√°rios."}),e.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Selecione um prestador e uma data."})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"‚è∞"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha o hor√°rio"}),e.jsx("p",{className:"text-gray-600",children:x&&`Para ${je(x,"dd 'de' MMMM 'de' yyyy",{locale:pe})}`})]}),z&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-2xl mb-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-500"})}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Carregando hor√°rios dispon√≠veis..."})]}),!z&&J.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üòî"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Nenhum hor√°rio dispon√≠vel para esta data."})]}),!z&&J.length>0&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:J.map((t,s)=>e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-4 transition-all duration-300 transform hover:scale-[1.02] ${(m==null?void 0:m.startTime)===t.startTime?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>Pe(t),children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`font-bold text-lg ${(m==null?void 0:m.startTime)===t.startTime?"text-white":"text-gray-800"}`,children:t.startTime}),e.jsxs("div",{className:`text-sm ${(m==null?void 0:m.startTime)===t.startTime?"text-white/80":"text-gray-500"}`,children:["at√© ",t.endTime]})]}),(m==null?void 0:m.startTime)===t.startTime&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-5 h-5 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-3 h-3 text-white"})})})]},s))}),m&&e.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-2xl",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"h-4 w-4 text-white"})}),e.jsxs("span",{className:"text-green-800 font-semibold",children:["Hor√°rio selecionado: ",m.startTime," - ",m.endTime]})]})}),m&&e.jsx("div",{className:"pt-6",children:e.jsxs(E,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:T,disabled:z,children:["Ir para Pagamento ",e.jsx(R,{className:"ml-2 h-5 w-5"})]})})]}),_e=()=>{const t=(w==null?void 0:w.filter(r=>l.includes(r.id)))||[],s=f==null?void 0:f.find(r=>r.id===d),o=(k==null?void 0:k.fixedFee)||0,i=O+o;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üí≥"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"M√©todo de pagamento"}),e.jsx("p",{className:"text-gray-600",children:"Escolha como voc√™ deseja pagar"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-2xl border border-gray-200",children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üìã"}),"Resumo do agendamento"]}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Servi√ßos:"}),e.jsxs("span",{className:"font-semibold text-gray-800",children:[t.length," servi√ßo(s)"]})]}),t.map((r,h)=>e.jsx("div",{className:"ml-4 text-sm border-l-2 border-teal-200 pl-3 py-1 bg-white/50 rounded-r-lg",children:e.jsx("span",{className:"text-gray-700",children:r.name})},r.id)),e.jsxs("div",{className:"mt-3 border-t border-gray-200 pt-3 flex justify-between text-sm font-semibold",children:[e.jsx("span",{children:"Dura√ß√£o total:"}),e.jsxs("span",{className:"text-teal-600",children:[F," minutos"]})]}),O>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm font-semibold",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{className:"text-teal-600",children:`R$ ${(O/100).toFixed(2).replace(".",",")}`})]}),o>0&&e.jsxs("div",{className:"flex justify-between text-sm font-semibold",children:[e.jsx("span",{children:"Taxa administrativa:"}),e.jsxs("span",{className:"text-teal-600",children:["R$ ",(o/100).toFixed(2).replace(".",",")]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t border-teal-200 pt-3 mt-3 bg-white/50 rounded-lg p-3",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-teal-600",children:["R$ ",(i/100).toFixed(2).replace(".",",")]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Prestador:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:(s==null?void 0:s.name)||"Prestador selecionado"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Data:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:x?je(x,"dd 'de' MMMM 'de' yyyy",{locale:pe}):"Data selecionada"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Hor√°rio:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:m?`${m.startTime} - ${m.endTime}`:"Hor√°rio selecionado"})]})]})]})]}),L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:L==="local"?"Escolha como deseja pagar no local":"Escolha como deseja pagar online"}),e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>ie(null),className:"text-sm hover:bg-gray-100",disabled:I,children:"Voltar"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:L==="local"?e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="money"?"bg-gradient-to-br from-green-500 to-emerald-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-green-300 hover:shadow-lg"}`,onClick:()=>q("money"),disabled:I,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="money"?"bg-white/20":"bg-green-100"}`,children:e.jsx("span",{className:"text-xl",children:"üíµ"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="money"?"text-white":"text-gray-800"}`,children:"Dinheiro"}),e.jsx("p",{className:`text-sm mt-1 ${n==="money"?"text-white/80":"text-gray-600"}`,children:"Pagamento em dinheiro"})]})]}),n==="money"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="credit_card"?"bg-gradient-to-br from-blue-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-blue-300 hover:shadow-lg"}`,onClick:()=>q("credit_card"),disabled:I,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="credit_card"?"bg-white/20":"bg-blue-100"}`,children:e.jsx("span",{className:"text-xl",children:"üí≥"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="credit_card"?"text-white":"text-gray-800"}`,children:"Cart√£o de Cr√©dito"}),e.jsx("p",{className:`text-sm mt-1 ${n==="credit_card"?"text-white/80":"text-gray-600"}`,children:"Pague com cart√£o de cr√©dito"})]})]}),n==="credit_card"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]}),e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="debit_card"?"bg-gradient-to-br from-green-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-green-300 hover:shadow-lg"}`,onClick:()=>q("debit_card"),disabled:I,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="debit_card"?"bg-white/20":"bg-green-100"}`,children:e.jsx("span",{className:"text-xl",children:"üè¶"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="debit_card"?"text-white":"text-gray-800"}`,children:"Cart√£o de D√©bito"}),e.jsx("p",{className:`text-sm mt-1 ${n==="debit_card"?"text-white/80":"text-gray-600"}`,children:"Pague com cart√£o de d√©bito"})]})]}),n==="debit_card"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]}),e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="pix"?"bg-gradient-to-br from-yellow-400 to-green-400 text-white shadow-xl":"bg-white border border-gray-200 hover:border-yellow-400 hover:shadow-lg"}`,onClick:()=>q("pix"),disabled:I,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="pix"?"bg-white/20":"bg-yellow-100"}`,children:e.jsx("span",{className:"text-xl",children:"‚ö°"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="pix"?"text-white":"text-gray-800"}`,children:"PIX"}),e.jsx("p",{className:`text-sm mt-1 ${n==="pix"?"text-white/80":"text-gray-600"}`,children:"Pague com PIX (QR Code)"})]})]}),n==="pix"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]})]})})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("button",{className:"group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg",onClick:()=>ke("local"),disabled:I,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110",children:e.jsx("span",{className:"text-2xl",children:"üíµ"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:"Pagamento Local"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Pague diretamente ao prestador no dia do servi√ßo"})]})]})}),e.jsx("button",{className:"group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform opacity-60 cursor-not-allowed bg-white border border-gray-200",disabled:!0,title:"Em breve dispon√≠vel",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-gray-400 to-gray-500 rounded-2xl flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"üí≥"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-500",children:"Pagamento Online"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Em breve dispon√≠vel"})]})]})})]})}),L&&n&&e.jsx("div",{className:"pt-6",children:e.jsxs(E,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:Ee,disabled:I,children:["Finalizar Agendamento ",e.jsx(R,{className:"ml-2 h-5 w-5"})]})})]})},Re=()=>e.jsx("div",{className:"space-y-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center mb-6 shadow-xl",children:e.jsx("span",{className:"text-4xl",children:"‚úÖ"})}),e.jsx("h2",{className:"text-3xl font-bold mb-3 text-gray-800",children:"Agendamento Confirmado!"}),e.jsx("p",{className:"text-gray-600 mb-6 text-lg",children:"Seu agendamento foi realizado com sucesso."}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-2xl border border-green-200 mb-6",children:e.jsx("p",{className:"text-green-800 font-semibold",children:"Voc√™ receber√° uma confirma√ß√£o por email em breve."})}),e.jsx(E,{className:"bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white px-8 py-3 rounded-xl font-semibold shadow-lg transition-all transform hover:scale-105",onClick:()=>window.location.href="/client/booking-confirmation-page",children:"Ver meus agendamentos"})]})}),Be=()=>{switch(a){case"niche":return"Escolha a √°rea de servi√ßo";case"category":return"Selecione a categoria";case"service":return"Qual servi√ßo voc√™ precisa?";case"date":return"Selecione uma data";case"providers":return"Prestadores dispon√≠veis";case"time-slot":return"Escolha um hor√°rio";case"payment":return"Escolha o m√©todo de pagamento";case"confirmation":return"Confirma√ß√£o do Agendamento";default:return"Novo Agendamento"}},_=["niche","category","service","date","providers","time-slot","payment","confirmation"];return e.jsxs("div",{className:"min-h-screen w-full bg-white relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-teal-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-blue-500/5 rounded-full blur-2xl"})]}),e.jsx("div",{className:"relative z-10 pt-6 pb-4",children:e.jsx("div",{className:"max-w-md mx-auto px-4",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-4 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{className:`rounded-xl bg-gray-100 p-3 transition-all hover:bg-gray-200 hover:scale-105 ${a==="niche"||a==="confirmation"?"invisible":""}`,onClick:Se,"aria-label":"Voltar",disabled:a==="niche"||a==="confirmation",style:{pointerEvents:a==="niche"||a==="confirmation"?"none":"auto"},children:e.jsx(Ge,{className:"h-5 w-5 text-neutral-700"})}),e.jsx("h2",{className:"text-lg font-extrabold text-neutral-900 text-center flex-1",children:Be()}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-teal-400 to-cyan-400 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${(_.indexOf(a)+1)/_.length*100}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-neutral-500",children:[e.jsxs("span",{children:["Passo ",_.indexOf(a)+1]}),e.jsxs("span",{children:["de ",_.length]})]})]})]})})}),e.jsx("div",{className:"relative z-10 px-4 pb-8",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx("div",{className:"bg-white/95 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/30 overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"min-h-[400px] flex flex-col justify-center",children:[a==="niche"&&Fe(),a==="category"&&Me(),a==="service"&&Ae(),a==="date"&&Oe(),a==="providers"&&ze(),a==="time-slot"&&qe(),a==="payment"&&_e(),a==="confirmation"&&Re()]})})})})}),we&&y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-teal-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl",children:fe(y.name)})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:y.name})]}),e.jsx("button",{onClick:()=>W(!1),className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors",children:e.jsx("span",{className:"text-gray-600",children:"√ó"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Descri√ß√£o"}),e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:y.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Pre√ßo"}),e.jsxs("div",{className:"font-bold text-teal-600 text-lg",children:["R$ ",(y.price/100).toFixed(2).replace(".",",")]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Dura√ß√£o"}),e.jsxs("div",{className:"font-bold text-gray-800 text-lg",children:[y.duration," min"]})]})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>W(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Fechar"}),e.jsx("button",{onClick:()=>{ge(y.id),W(!1)},className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${l.includes(y.id)?"bg-gray-500 text-white":"bg-teal-500 text-white hover:bg-teal-600"}`,children:l.includes(y.id)?"J√° Selecionado":"Selecionar Servi√ßo"})]})]})})]})}function Tt(){const[Z,$]=be(),[B,C]=c.useState(null);c.useEffect(()=>{const v=new URLSearchParams(window.location.search).get("serviceId");v&&!isNaN(parseInt(v))&&console.log("Par√¢metro serviceId detectado, mas n√£o usado para pr√©-sele√ß√£o:",v)},[Z]);const H=a=>{if(console.log("Agendamento finalizado com dados:",a),a.date&&a.startTime&&a.endTime&&a.paymentMethod){const v=a.serviceId||(a.serviceIds&&a.serviceIds.length>0?a.serviceIds[0]:0),j=a.serviceIds&&a.serviceIds.length>1;let D=`/client/booking-confirmation/${a.providerId}/${v}/${a.date}/${a.startTime}/${a.endTime}`;if(j&&a.serviceIds){const p=a.serviceIds.slice(1).join(",");D+=`?additionalServices=${p}`}$(D)}};return e.jsxs(e.Fragment,{children:[e.jsx(We,{children:e.jsx("title",{children:"Agendar Servi√ßo | AgendoAI"})}),e.jsx(Qe,{children:e.jsxs("div",{className:"w-full min-h-screen flex flex-col items-center bg-white",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-neutral-900 mb-4 text-center mt-4 tracking-tight",children:"Novo agendamento"}),e.jsx("div",{className:"w-full flex-1 flex flex-col items-center",children:e.jsx(tt,{onComplete:H,preSelectedServiceId:null})})]})})]})}export{Tt as default};
