import{c as He,u as Ke,a as pe,r as c,R as Ve,d as O,j as e,O as X,H as We}from"./index-DFO2lo2s.js";import{C as Je}from"./client-layout-Dqh0s42V.js";import{B as k}from"./button-6IH7luFD.js";import{C as Qe}from"./calendar-CiY0AdYf.js";import{C as Ue}from"./chevron-left-CKZU-S_c.js";import{C as N}from"./check-C4mt73Rm.js";import{C as q}from"./chevron-right-BpYdX1P5.js";import{S as Z}from"./sparkles-B780Ik13.js";import{H as Xe}from"./house-sGd4nDnu.js";import{C as Ze,H as Ge}from"./heart-86fS5oDf.js";import{S as Ye}from"./scissors-eiDpte-K.js";import{f as fe}from"./format-CGvBu07F.js";import{p as je}from"./pt-BR-Cxqo7XV3.js";import"./navbar-BoNMuwo_.js";import"./proxy-BltBotVH.js";import"./search-CMPUhstB.js";import"./calendar-check-CDRCjfO9.js";import"./user-WwS7npix.js";import"./en-US-xSPtgCq_.js";import"./endOfMonth-CH6FLORf.js";import"./isSameDay-BJjwZdUf.js";import"./addDays-BQ37Zmqx.js";function et({onComplete:G,preSelectedServiceId:S=null}){console.log("NewBookingWizard RENDERIZADO");const{toast:_}=He(),{user:$}=Ke(),[,B]=pe(),[a,b]=c.useState("niche"),[j,E]=c.useState(null),[p,Y]=c.useState(null),[l,ee]=c.useState(S?[S]:[]),[x,te]=c.useState(null),[d,se]=c.useState(null),[m,ae]=c.useState(null),[D,re]=c.useState(null),[n,ie]=c.useState(null),[A,ve]=c.useState(0),[F,be]=c.useState(0),[I,H]=c.useState({}),[le,K]=c.useState({}),[ne,oe]=c.useState(null),[V,Ne]=c.useState([]),[M,de]=c.useState(!1),[y,tt]=c.useState(null),[ye,W]=c.useState(!1);Ve.useEffect(()=>{if(!d||!x||a!=="time-slot")return;(async()=>{de(!0);try{const s=ne||A||30,o=`/api/providers/${d}/time-slots?date=${x.toISOString().split("T")[0]}&duration=${s}`,r=await(await fetch(o)).json();console.log("[API] /api/providers/:id/time-slots - RESPOSTA:",r),Ne(Array.isArray(r)?r:r.timeSlots||[])}catch(s){console.error("Erro ao buscar hor√°rios:",s)}finally{de(!1)}})()},[d,x,ne,A,a]),c.useEffect(()=>{S&&fetch(`/api/services/${S}`).then(t=>t.json()).then(t=>{t&&t.categoryId&&(Y(t.categoryId),fetch(`/api/categories/${t.categoryId}`).then(s=>s.json()).then(s=>{s&&s.nicheId&&E(s.nicheId)}))})},[S]);const{data:J,isLoading:ce}=O({queryKey:["/api/niches"],staleTime:6e4}),{data:Q,isLoading:me}=O({queryKey:["/api/niches",j,"categories"],queryFn:()=>j?fetch(`/api/niches/${j}/categories`).then(t=>t.json()):null,enabled:!!j,staleTime:6e4}),{data:w,isLoading:U}=O({queryKey:["/api/services",p],queryFn:()=>p?fetch(`/api/services?categoryId=${p}`).then(t=>t.json()):null,enabled:!!p,staleTime:6e4});c.useEffect(()=>{},[l,x]);const{data:f,isLoading:L}=O({queryKey:["/api/providers",l,x],queryFn:async()=>{if(l.length===0||!x)return[];l[0];const s=await(await fetch(`/api/providers/service-search?serviceIds=${l.join(",")}&date=${x.toISOString().split("T")[0]}`)).json();return console.log("DADOS RECEBIDOS DA API /api/providers/service-search:",s),(s.providers||[]).map(r=>r.provider?r.provider:r)},enabled:l.length>0&&!!x,staleTime:6e4});c.useEffect(()=>{if(f&&f.length>0&&l.length>0&&x){const t={};let s=0;const o=f.filter(i=>i&&i.id).length;if(o===0)return;f.forEach(i=>{if(!i||!i.id){s++;return}K(r=>({...r,[i.id]:!0})),fetch(`/api/provider-services/provider/${i.id}`).then(r=>{if(!r.ok)throw new Error(`Erro ao buscar servi√ßos: ${r.status}`);return r.json()}).then(r=>{const h=Array.isArray(r)?r.filter(g=>g&&g.serviceId&&l.includes(g.serviceId)).map(g=>({id:g.serviceId,name:g.serviceName||"Servi√ßo",duration:g.executionTime||g.defaultDuration||30,price:g.price||0})):[];let u=0;h&&h.length>0&&h.forEach(g=>{const Be=parseInt(g.duration)||0;u+=Be});const v=u>0?u:A||60;return fetch(`/api/providers/${i.id}/time-slots?date=${x.toISOString().split("T")[0]}&duration=${v}`).then(g=>g.json()).then(g=>(console.log("[API] /api/providers/:id/time-slots - RESPOSTA:",g),Array.isArray(g)&&g.length>0&&(t[i.id]=h),{hasSlots:Array.isArray(g)&&g.length>0,provider:i,services:h}))}).then(({hasSlots:r,provider:h,services:u})=>{r&&H(v=>({...v,[h.id]:u})),K(v=>({...v,[h.id]:!1})),s++,s===o&&(f.filter(v=>t[v.id]),H({...t}))}).catch(r=>{K(h=>({...h,[i.id]:!1})),s++})})}},[f,l,x,A]);const xe=c.useCallback(async(t,s)=>{if(!t||!s)return null;try{const o=await fetch(`/api/provider-services/provider/${t}/service/${s}`);if(!o.ok)return null;const i=await o.json();return i.executionTime||i.duration||null}catch{return null}},[]);c.useEffect(()=>{async function t(){if(d&&l.length===1){const s=await xe(d,l[0]);oe(s)}else oe(null)}t()},[d,l,xe]),c.useEffect(()=>{a==="service"&&l.length>0&&b("date"),te(null),se(null),ae(null),H({})},[l]);const C=()=>{const t=["niche","category","service","date","providers","time-slot","payment","confirmation"],s=t.indexOf(a);s<t.length-1&&b(t[s+1])},we=()=>{const t=["niche","category","service","date","providers","time-slot","payment","confirmation"],s=t.indexOf(a);s>0&&b(t[s-1])},Se=t=>{E(t),C()},$e=t=>{Y(t),ee([]),C()},he=t=>{const s=l.includes(t);let o;s?o=l.filter(i=>i!==t):o=[t],ee(o)},Ce=t=>{te(t),C()},Te=(t,s,o)=>{se(t),s!==void 0&&ve(s),o!==void 0&&be(o),C()},Ie=t=>{ae(t)},Pe=t=>{re(t),ie(null)},R=t=>{ie(t)},ke=async()=>{var o;if(l.length===0||!d||!x||!m||!D||!n){_({title:"Erro ao finalizar agendamento",description:"Por favor, preencha todas as informa√ß√µes necess√°rias.",variant:"destructive"});return}const t=(P==null?void 0:P.fixedFee)||0,s=F+t;if(n==="pix"||n==="credit_card"||n==="debit_card"){const i={providerId:d,serviceId:l[0],date:x.toISOString().split("T")[0],startTime:m.startTime,endTime:m.endTime,totalPrice:s,paymentMethod:n,...l.length>1&&{multipleServices:!0,serviceIds:l,services:l.map(r=>{const h=(I[d]||[]).find(u=>u.id===r);return{serviceId:r,duration:(h==null?void 0:h.duration)||30}})}};sessionStorage.setItem("pendingBookingData",JSON.stringify(i)),B(`/client/payment?amount=${s}&paymentMethod=${n}`);return}try{const i=(w==null?void 0:w.filter(u=>l.includes(u.id)))||[],r=f==null?void 0:f.find(u=>u.id===d);let h;if(l.length===1?h=await fetch("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({providerId:d,serviceId:l[0],date:x.toISOString().split("T")[0],startTime:m.startTime,paymentMethod:n,totalPrice:s,paymentStatus:"pending",serviceName:((o=i[0])==null?void 0:o.name)||"Servi√ßo",clientName:($==null?void 0:$.name)||"Cliente"})}):h=await fetch("/api/booking/consecutive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({providerId:d,date:x.toISOString().split("T")[0],startTime:m.startTime,paymentMethod:n,totalPrice:s,paymentStatus:"pending",serviceName:i.map(u=>u.name).join(", "),clientName:($==null?void 0:$.name)||"Cliente",services:l.map(u=>{const v=(I[d]||[]).find(g=>g.id===u);return{serviceId:u,duration:(v==null?void 0:v.duration)||30}})})}),!h.ok){const u=await h.json();throw new Error(u.error||"Erro ao criar agendamento")}b("confirmation")}catch(i){_({title:"Erro ao criar agendamento",description:i.message||"Tente novamente.",variant:"destructive"})}},Ee=t=>{const s=I[t]||[];let o=0,i=0;return s.filter(r=>l.includes(r.id)).forEach(r=>{o+=r.duration||0,i+=r.price||0}),{duration:o,price:i}},{data:P,isLoading:T}=O({queryKey:["/api/provider-fees",d],queryFn:async()=>{if(!d)return null;const t=await fetch(`/api/provider-fees/${d}`);return t.ok?await t.json():null},enabled:!!d});function ge(t){switch(t==null?void 0:t.toLowerCase()){case"beleza":return e.jsx(Ye,{className:"h-10 w-10"});case"sa√∫de":return e.jsx(Ge,{className:"h-10 w-10"});case"automotivo":return e.jsx(Ze,{className:"h-10 w-10"});case"casa":return e.jsx(Xe,{className:"h-10 w-10"});default:return e.jsx(Z,{className:"h-10 w-10"})}}function De(t){return ge(t)}function ue(t,s=!1){return s?e.jsx(Z,{className:"h-8 w-8"}):e.jsx(Z,{className:"h-10 w-10"})}const Ae=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üéØ"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha sua √°rea"}),e.jsx("p",{className:"text-gray-600",children:"Selecione a categoria que melhor atende sua necessidade"})]}),ce?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(X,{})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:J==null?void 0:J.map(t=>e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${j===t.id?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>Se(t.id),disabled:ce,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`text-2xl transition-transform group-hover:scale-110 ${j===t.id?"text-white":"text-teal-500"}`,children:ge(t.name)}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`font-semibold text-lg ${j===t.id?"text-white":"text-gray-800"}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 ${j===t.id?"text-white/80":"text-gray-500"}`,children:"Servi√ßos especializados"})]})]}),j===t.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]},t.id))})]}),Le=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üìÇ"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Selecione a categoria"}),e.jsx("p",{className:"text-gray-600",children:"Escolha o tipo de servi√ßo que voc√™ precisa"})]}),me?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(X,{})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:Q==null?void 0:Q.map(t=>e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${p===t.id?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>$e(t.id),disabled:me,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`text-2xl transition-transform group-hover:scale-110 ${p===t.id?"text-white":"text-teal-500"}`,children:De(t.name)}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`font-semibold text-lg ${p===t.id?"text-white":"text-gray-800"}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 ${p===t.id?"text-white/80":"text-gray-500"}`,children:"Servi√ßos dispon√≠veis"})]})]}),p===t.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]},t.id))})]}),Oe=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üõ†Ô∏è"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha seus servi√ßos"}),e.jsx("p",{className:"text-gray-600",children:"Selecione um ou mais servi√ßos que voc√™ precisa"})]}),U?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(X,{})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:w==null?void 0:w.map(t=>e.jsxs("div",{className:`group relative overflow-hidden rounded-xl transition-all duration-300 transform hover:scale-[1.01] ${l.includes(t.id)?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>{U||he(t.id)},style:{cursor:U?"not-allowed":"pointer"},children:[e.jsx("div",{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx("div",{className:`w-8 h-8 sm:w-12 sm:h-12 rounded-full flex items-center justify-center transition-transform group-hover:scale-105 ${l.includes(t.id)?"bg-white/20":"bg-teal-100"}`,children:e.jsx("span",{className:"text-lg sm:text-xl",children:ue(t.name,!0)})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-base sm:text-lg ${l.includes(t.id)?"text-white":"text-gray-800"}`,children:t.name}),e.jsx("p",{className:`text-xs sm:text-sm mt-1 ${l.includes(t.id)?"text-white/80":"text-gray-600"}`,children:t.description.length>40?`${t.description.substring(0,40)}...`:t.description})]})]}),e.jsx("div",{className:"text-right"})]})}),l.includes(t.id)&&e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3",children:e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})})})]},t.id))})]}),Fe=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üìÖ"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha a data"}),e.jsx("p",{className:"text-gray-600",children:"Selecione quando voc√™ gostaria de agendar"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-200",children:e.jsx(Qe,{mode:"single",selected:x,onSelect:Ce,disabled:t=>{const s=new Date;return s.setHours(0,0,0,0),t<s},className:"rounded-xl"})})}),x&&e.jsx("div",{className:"pt-6",children:e.jsxs(k,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:C,disabled:L,children:["Ver Prestadores ",e.jsx(q,{className:"ml-2 h-5 w-5"})]})})]}),Me=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üë•"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha o prestador"}),e.jsx("p",{className:"text-gray-600",children:"Selecione quem ir√° realizar seu servi√ßo"})]}),L?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-6",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Buscando prestadores..."}),e.jsx("p",{className:"text-gray-600",children:"Carregando profissionais dispon√≠veis para sua data"})]}):f&&f.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:f.map((t,s)=>{const o=Ee(t.id),i=le[t.id];return e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${d===t.id?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"} ${i?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{!i&&!L&&Te(t.id,o.duration,o.price)},disabled:i||L,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center transition-transform group-hover:scale-110 ${d===t.id?"bg-white/20":"bg-teal-100"}`,children:e.jsx("span",{className:"text-lg",children:"üë§"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${d===t.id?"text-white":"text-gray-800"}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 ${d===t.id?"text-white/80":"text-gray-600"}`,children:i?"Carregando servi√ßos...":"Prestador dispon√≠vel"})]})]}),e.jsxs("div",{className:"text-right",children:[I[t.id]&&I[t.id].length>0&&I[t.id].map((r,h)=>e.jsxs("div",{className:"text-sm font-semibold text-neutral-800",children:[r.name," - R$ ",Number(r.price).toFixed(2).replace(".",",")]},r.id)),e.jsxs("div",{className:`text-sm ${d===t.id?"text-white/70":"text-gray-500"}`,children:[o.duration," min"]})]})]}),d===t.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]},t.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üòî"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Nenhum prestador dispon√≠vel para esta data."})]}),d&&e.jsx("div",{className:"pt-6",children:e.jsxs(k,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:C,disabled:le[d]||L,children:["Escolher Hor√°rio ",e.jsx(q,{className:"ml-2 h-5 w-5"})]})})]}),Re=()=>!d||!x?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-yellow-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"‚ö†Ô∏è"})}),e.jsx("p",{className:"text-yellow-800 font-semibold",children:"Dados insuficientes para buscar hor√°rios."}),e.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Selecione um prestador e uma data."})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"‚è∞"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha o hor√°rio"}),e.jsx("p",{className:"text-gray-600",children:x&&`Para ${fe(x,"dd 'de' MMMM 'de' yyyy",{locale:je})}`})]}),M&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-2xl mb-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-500"})}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Carregando hor√°rios dispon√≠veis..."})]}),!M&&V.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üòî"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Nenhum hor√°rio dispon√≠vel para esta data."})]}),!M&&V.length>0&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:V.map((t,s)=>e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-4 transition-all duration-300 transform hover:scale-[1.02] ${(m==null?void 0:m.startTime)===t.startTime?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>Ie(t),children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`font-bold text-lg ${(m==null?void 0:m.startTime)===t.startTime?"text-white":"text-gray-800"}`,children:t.startTime}),e.jsxs("div",{className:`text-sm ${(m==null?void 0:m.startTime)===t.startTime?"text-white/80":"text-gray-500"}`,children:["at√© ",t.endTime]})]}),(m==null?void 0:m.startTime)===t.startTime&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-5 h-5 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-3 h-3 text-white"})})})]},s))}),m&&e.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-2xl",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"h-4 w-4 text-white"})}),e.jsxs("span",{className:"text-green-800 font-semibold",children:["Hor√°rio selecionado: ",m.startTime," - ",m.endTime]})]})}),m&&e.jsx("div",{className:"pt-6",children:e.jsxs(k,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:C,disabled:M,children:["Ir para Pagamento ",e.jsx(q,{className:"ml-2 h-5 w-5"})]})})]}),ze=()=>{const t=(w==null?void 0:w.filter(r=>l.includes(r.id)))||[],s=f==null?void 0:f.find(r=>r.id===d),o=(P==null?void 0:P.fixedFee)||0,i=F+o;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üí≥"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"M√©todo de pagamento"}),e.jsx("p",{className:"text-gray-600",children:"Escolha como voc√™ deseja pagar"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-2xl border border-gray-200",children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üìã"}),"Resumo do agendamento"]}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Servi√ßos:"}),e.jsxs("span",{className:"font-semibold text-gray-800",children:[t.length," servi√ßo(s)"]})]}),t.map((r,h)=>e.jsx("div",{className:"ml-4 text-sm border-l-2 border-teal-200 pl-3 py-1 bg-white/50 rounded-r-lg",children:e.jsx("span",{className:"text-gray-700",children:r.name})},r.id)),e.jsxs("div",{className:"mt-3 border-t border-gray-200 pt-3 flex justify-between text-sm font-semibold",children:[e.jsx("span",{children:"Dura√ß√£o total:"}),e.jsxs("span",{className:"text-teal-600",children:[A," minutos"]})]}),F>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm font-semibold",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{className:"text-teal-600",children:["R$ ",F.toFixed(2).replace(".",",")]})]}),o>0&&e.jsxs("div",{className:"flex justify-between text-sm font-semibold",children:[e.jsx("span",{children:"Taxa administrativa:"}),e.jsxs("span",{className:"text-teal-600",children:["R$ ",o.toFixed(2).replace(".",",")]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t border-teal-200 pt-3 mt-3 bg-white/50 rounded-lg p-3",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-teal-600",children:["R$ ",i.toFixed(2).replace(".",",")]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Prestador:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:(s==null?void 0:s.name)||"Prestador selecionado"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Data:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:x?fe(x,"dd 'de' MMMM 'de' yyyy",{locale:je}):"Data selecionada"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Hor√°rio:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:m?`${m.startTime} - ${m.endTime}`:"Hor√°rio selecionado"})]})]})]})]}),D?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:D==="local"?"Escolha como deseja pagar no local":"Escolha como deseja pagar online"}),e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>re(null),className:"text-sm hover:bg-gray-100",disabled:T,children:"Voltar"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:D==="local"?e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="money"?"bg-gradient-to-br from-green-500 to-emerald-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-green-300 hover:shadow-lg"}`,onClick:()=>R("money"),disabled:T,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="money"?"bg-white/20":"bg-green-100"}`,children:e.jsx("span",{className:"text-xl",children:"üíµ"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="money"?"text-white":"text-gray-800"}`,children:"Dinheiro"}),e.jsx("p",{className:`text-sm mt-1 ${n==="money"?"text-white/80":"text-gray-600"}`,children:"Pagamento em dinheiro"})]})]}),n==="money"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="credit_card"?"bg-gradient-to-br from-blue-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-blue-300 hover:shadow-lg"}`,onClick:()=>R("credit_card"),disabled:T,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="credit_card"?"bg-white/20":"bg-blue-100"}`,children:e.jsx("span",{className:"text-xl",children:"üí≥"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="credit_card"?"text-white":"text-gray-800"}`,children:"Cart√£o de Cr√©dito"}),e.jsx("p",{className:`text-sm mt-1 ${n==="credit_card"?"text-white/80":"text-gray-600"}`,children:"Pague com cart√£o de cr√©dito"})]})]}),n==="credit_card"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]}),e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="debit_card"?"bg-gradient-to-br from-green-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-green-300 hover:shadow-lg"}`,onClick:()=>R("debit_card"),disabled:T,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="debit_card"?"bg-white/20":"bg-green-100"}`,children:e.jsx("span",{className:"text-xl",children:"üè¶"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="debit_card"?"text-white":"text-gray-800"}`,children:"Cart√£o de D√©bito"}),e.jsx("p",{className:`text-sm mt-1 ${n==="debit_card"?"text-white/80":"text-gray-600"}`,children:"Pague com cart√£o de d√©bito"})]})]}),n==="debit_card"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]}),e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="pix"?"bg-gradient-to-br from-yellow-400 to-green-400 text-white shadow-xl":"bg-white border border-gray-200 hover:border-yellow-400 hover:shadow-lg"}`,onClick:()=>R("pix"),disabled:T,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="pix"?"bg-white/20":"bg-yellow-100"}`,children:e.jsx("span",{className:"text-xl",children:"‚ö°"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="pix"?"text-white":"text-gray-800"}`,children:"PIX"}),e.jsx("p",{className:`text-sm mt-1 ${n==="pix"?"text-white/80":"text-gray-600"}`,children:"Pague com PIX (QR Code)"})]})]}),n==="pix"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})})})]})]})})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("button",{className:"group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg",onClick:()=>Pe("local"),disabled:T,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110",children:e.jsx("span",{className:"text-2xl",children:"üíµ"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:"Pagamento Local"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Pague diretamente ao prestador no dia do servi√ßo"})]})]})}),e.jsx("button",{className:"group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform opacity-60 cursor-not-allowed bg-white border border-gray-200",disabled:!0,title:"Em breve dispon√≠vel",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-gray-400 to-gray-500 rounded-2xl flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"üí≥"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-500",children:"Pagamento Online"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Em breve dispon√≠vel"})]})]})})]})}),D&&n&&e.jsx("div",{className:"pt-6",children:e.jsxs(k,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:ke,disabled:T,children:["Finalizar Agendamento ",e.jsx(q,{className:"ml-2 h-5 w-5"})]})})]})},qe=()=>e.jsx("div",{className:"space-y-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center mb-6 shadow-xl",children:e.jsx("span",{className:"text-4xl",children:"‚úÖ"})}),e.jsx("h2",{className:"text-3xl font-bold mb-3 text-gray-800",children:"Agendamento Confirmado!"}),e.jsx("p",{className:"text-gray-600 mb-6 text-lg",children:"Seu agendamento foi realizado com sucesso."}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-2xl border border-green-200 mb-6",children:e.jsx("p",{className:"text-green-800 font-semibold",children:"Voc√™ receber√° uma confirma√ß√£o por email em breve."})}),e.jsx(k,{className:"bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white px-8 py-3 rounded-xl font-semibold shadow-lg transition-all transform hover:scale-105",onClick:()=>window.location.href="/client/booking-confirmation-page",children:"Ver meus agendamentos"})]})}),_e=()=>{switch(a){case"niche":return"Escolha a √°rea de servi√ßo";case"category":return"Selecione a categoria";case"service":return"Qual servi√ßo voc√™ precisa?";case"date":return"Selecione uma data";case"providers":return"Prestadores dispon√≠veis";case"time-slot":return"Escolha um hor√°rio";case"payment":return"Escolha o m√©todo de pagamento";case"confirmation":return"Confirma√ß√£o do Agendamento";default:return"Novo Agendamento"}},z=["niche","category","service","date","providers","time-slot","payment","confirmation"];return e.jsxs("div",{className:"min-h-screen w-full bg-white relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-teal-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-blue-500/5 rounded-full blur-2xl"})]}),e.jsx("div",{className:"relative z-10 pt-6 pb-4",children:e.jsx("div",{className:"max-w-md mx-auto px-4",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-4 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{className:`rounded-xl bg-gray-100 p-3 transition-all hover:bg-gray-200 hover:scale-105 ${a==="niche"||a==="confirmation"?"invisible":""}`,onClick:we,"aria-label":"Voltar",disabled:a==="niche"||a==="confirmation",style:{pointerEvents:a==="niche"||a==="confirmation"?"none":"auto"},children:e.jsx(Ue,{className:"h-5 w-5 text-neutral-700"})}),e.jsx("h2",{className:"text-lg font-extrabold text-neutral-900 text-center flex-1",children:_e()}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-teal-400 to-cyan-400 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${(z.indexOf(a)+1)/z.length*100}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-neutral-500",children:[e.jsxs("span",{children:["Passo ",z.indexOf(a)+1]}),e.jsxs("span",{children:["de ",z.length]})]})]})]})})}),e.jsx("div",{className:"relative z-10 px-4 pb-8",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx("div",{className:"bg-white/95 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/30 overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"min-h-[400px] flex flex-col justify-center",children:[a==="niche"&&Ae(),a==="category"&&Le(),a==="service"&&Oe(),a==="date"&&Fe(),a==="providers"&&Me(),a==="time-slot"&&Re(),a==="payment"&&ze(),a==="confirmation"&&qe()]})})})})}),ye&&y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-teal-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl",children:ue(y.name)})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:y.name})]}),e.jsx("button",{onClick:()=>W(!1),className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors",children:e.jsx("span",{className:"text-gray-600",children:"√ó"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Descri√ß√£o"}),e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:y.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Pre√ßo"}),e.jsxs("div",{className:"font-bold text-teal-600 text-lg",children:["R$ ",(y.price/100).toFixed(2).replace(".",",")]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Dura√ß√£o"}),e.jsxs("div",{className:"font-bold text-gray-800 text-lg",children:[y.duration," min"]})]})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>W(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Fechar"}),e.jsx("button",{onClick:()=>{he(y.id),W(!1)},className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${l.includes(y.id)?"bg-gray-500 text-white":"bg-teal-500 text-white hover:bg-teal-600"}`,children:l.includes(y.id)?"J√° Selecionado":"Selecionar Servi√ßo"})]})]})})]})}function St(){const[G,S]=pe(),[_,$]=c.useState(null);c.useEffect(()=>{const b=new URLSearchParams(window.location.search).get("serviceId");b&&!isNaN(parseInt(b))&&console.log("Par√¢metro serviceId detectado, mas n√£o usado para pr√©-sele√ß√£o:",b)},[G]);const B=a=>{if(console.log("Agendamento finalizado com dados:",a),a.date&&a.startTime&&a.endTime&&a.paymentMethod){const b=a.serviceId||(a.serviceIds&&a.serviceIds.length>0?a.serviceIds[0]:0),j=a.serviceIds&&a.serviceIds.length>1;let E=`/client/booking-confirmation/${a.providerId}/${b}/${a.date}/${a.startTime}/${a.endTime}`;if(j&&a.serviceIds){const p=a.serviceIds.slice(1).join(",");E+=`?additionalServices=${p}`}S(E)}};return e.jsxs(e.Fragment,{children:[e.jsx(We,{children:e.jsx("title",{children:"Agendar Servi√ßo | AgendoAI"})}),e.jsx(Je,{children:e.jsxs("div",{className:"w-full min-h-screen flex flex-col items-center bg-white",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-neutral-900 mb-4 text-center mt-4 tracking-tight",children:"Novo agendamento"}),e.jsx("div",{className:"w-full flex-1 flex flex-col items-center",children:e.jsx(et,{onComplete:B,preSelectedServiceId:null})})]})})]})}export{St as default};
