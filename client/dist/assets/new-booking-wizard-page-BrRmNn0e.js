import{j as e}from"./ui-UIpCtT3r.js";import{b as Je,u as We,n as p,c as O,F as X,B as k,H as Qe,o as Ue}from"./index-C8-zpcKL.js";import{C as Xe}from"./client-layout-DkJA58XK.js";import{r as c,a as Ge}from"./vendor-vA4cx1mx.js";import{u as ye}from"./router-CxXythJb.js";import{C as Ye}from"./calendar-DX713B9i.js";import{C as Ze}from"./chevron-left-tkC6Z4zt.js";import{C as b}from"./check-yFju7Kvd.js";import{C as _}from"./chevron-right-DnXY7g-Q.js";import{S as G}from"./sparkles-ChQkmO6S.js";import{C as es,H as ss}from"./heart-aUy0qgju.js";import{S as ts}from"./scissors-wRKqpZhE.js";import{f as be}from"./format-CGvBu07F.js";import{p as Ne}from"./pt-BR-Cxqo7XV3.js";import"./navbar-vyjn30u5.js";import"./proxy-B2Nma8Bt.js";import"./search-ChrBAPJG.js";import"./calendar-check-B0nV5Uhw.js";import"./user-CXc1AnQW.js";import"./en-US-xSPtgCq_.js";import"./endOfMonth-CH6FLORf.js";import"./isSameDay-BJjwZdUf.js";import"./addDays-BQ37Zmqx.js";import"./subDays-K6OA95hK.js";function as({onComplete:Y,preSelectedServiceId:S=null}){const{toast:B}=Je(),{user:$}=We(),[,H]=ye(),[r,v]=c.useState("niche"),[f,E]=c.useState(null),[j,Z]=c.useState(null),[l,ee]=c.useState(S?[S]:[]),[x,se]=c.useState(null),[o,te]=c.useState(null),[m,ae]=c.useState(null),[D,re]=c.useState(null),[n,ie]=c.useState(null),[F,we]=c.useState(0),[R,Se]=c.useState(0),[P,K]=c.useState({}),[le,ne]=c.useState({}),[oe,de]=c.useState(null),[V,$e]=c.useState([]),[z,ce]=c.useState(!1),[N,rs]=c.useState(null),[Ce,J]=c.useState(!1);Ge.useEffect(()=>{if(!o||!x||r!=="time-slot")return;(async()=>{ce(!0);try{const t=oe||F||30,a=`/api/providers/${o}/time-slots?date=${x.toISOString().split("T")[0]}&duration=${t}`,d=await(await fetch(a)).json();$e(Array.isArray(d)?d:d.timeSlots||[])}catch(t){console.error("Erro ao buscar hor√°rios:",t)}finally{ce(!1)}})()},[o,x,oe,F,r]),c.useEffect(()=>{S&&p(`/services/${S}`).then(s=>s.json()).then(s=>{s&&s.categoryId&&(Z(s.categoryId),p(`/categories/${s.categoryId}`).then(t=>t.json()).then(t=>{t&&t.nicheId&&E(t.nicheId)}))})},[S]);const{data:W,isLoading:me}=O({queryKey:["/api/niches"],staleTime:6e4}),{data:Q,isLoading:xe}=O({queryKey:["/api/niches",f,"categories"],queryFn:()=>f?p(`/niches/${f}/categories`).then(s=>s.json()):null,enabled:!!f,staleTime:6e4}),{data:y,isLoading:U}=O({queryKey:["/api/service-templates",j],queryFn:()=>j?p(`/api/service-templates?categoryId=${j}`).then(s=>s.json()):null,enabled:!!j,staleTime:6e4});c.useEffect(()=>{},[l,x]);const{data:g,isLoading:L}=O({queryKey:["/api/providers",l,x],queryFn:async()=>{if(l.length===0||!x)return[];const s=`/api/providers/service-search?serviceIds=${l.join(",")}&date=${x.toISOString().split("T")[0]}`,t=await p(s);return t.ok?((await t.json()).providers||[]).map(h=>({...h.provider||h,serviceDurations:h.services||[],totalServiceDuration:h.totalDuration||0,rating:h.rating||0})):(console.error("Erro na API:",t.status,t.statusText),[])},enabled:l.length>0&&!!x,staleTime:6e4});c.useEffect(()=>{if(g&&g.length>0&&l.length>0&&x){const s={},t=g.map(async a=>{if(!a||!a.id)return{hasSlots:!1,provider:a,services:[]};ne(i=>({...i,[a.id]:!0}));try{const i=await p(`/api/provider-services/provider/${a.id}`);let d=[];i.ok?d=await i.json()||[]:console.error(`Erro ao buscar servi√ßos do prestador ${a.id}:`,i.status);const u=d.filter(w=>l.includes(w.serviceId)).map(w=>({id:w.serviceId,name:w.serviceName||"Servi√ßo",duration:w.executionTime||w.duration||30,price:w.price||0,providerServiceId:w.id})),M=a.totalServiceDuration||F||60,pe=await(await p(`/api/providers/${a.id}/time-slots?date=${x.toISOString().split("T")[0]}&duration=${M}`)).json(),ve=Array.isArray(pe)&&pe.length>0;return ve&&(s[a.id]=u),{hasSlots:ve,provider:a,services:u}}catch(i){return console.error(`Erro ao verificar prestador ${a.id}:`,i),{hasSlots:!1,provider:a,services:[]}}finally{ne(i=>({...i,[a.id]:!1}))}});Promise.all(t).then(a=>{a.forEach(({hasSlots:i,provider:d,services:h})=>{i&&K(u=>({...u,[d.id]:h}))}),K({...s})}).catch(a=>{console.error("Erro ao verificar prestadores:",a)})}},[g,l,x,F]);const he=c.useCallback(async(s,t)=>{if(!s||!t)return null;try{const a=await p(`/provider-services/provider/${s}/service/${t}`);if(!a.ok)return null;const i=await a.json();return i.executionTime||i.duration||null}catch{return null}},[]);c.useEffect(()=>{async function s(){if(o&&l.length===1){const t=await he(o,l[0]);de(t)}else de(null)}s()},[o,l,he]),c.useEffect(()=>{r==="service"&&l.length>0&&v("date"),se(null),te(null),ae(null),K({})},[l]);const C=()=>{const s=["niche","category","service","date","providers","time-slot","payment","confirmation"],t=s.indexOf(r);t<s.length-1&&v(s[t+1])},Te=()=>{const s=["niche","category","service","date","providers","time-slot","payment","confirmation"],t=s.indexOf(r);t>0&&v(s[t-1])},Pe=s=>{E(s),C()},Ie=s=>{Z(s),ee([]),C()},ue=s=>{const t=l.includes(s);let a;t?a=l.filter(i=>i!==s):a=[s],ee(a)},ke=s=>{se(s),C()},Ee=(s,t,a)=>{te(s),t!==void 0&&we(t),a!==void 0&&Se(a),C()},De=s=>{ae(s)},Fe=s=>{re(s),ie(null)},q=s=>{ie(s)},Le=async()=>{var a;if(l.length===0||!o||!x||!m||!D||!n){B({title:"Erro ao finalizar agendamento",description:"Por favor, preencha todas as informa√ß√µes necess√°rias.",variant:"destructive"});return}const s=(I==null?void 0:I.fixedFee)||0,t=R+s;if(n==="pix"||n==="credit_card"||n==="debit_card"){const i={providerId:o,serviceId:l[0],date:x.toISOString().split("T")[0],startTime:m.startTime,endTime:m.endTime,totalPrice:t,paymentMethod:n,...l.length>1&&{multipleServices:!0,serviceIds:l,services:l.map(d=>{const h=(P[o]||[]).find(u=>u.id===d);return{serviceId:d,duration:(h==null?void 0:h.duration)||30}})}};sessionStorage.setItem("pendingBookingData",JSON.stringify(i)),H(`/client/payment?amount=${t}&paymentMethod=${n}`);return}try{const i=(y==null?void 0:y.filter(u=>l.includes(u.id)))||[],d=g==null?void 0:g.find(u=>u.id===o);let h;if(l.length===1?h=await p("/api/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({providerId:o,serviceId:l[0],date:x.toISOString().split("T")[0],startTime:m.startTime,paymentMethod:n,totalPrice:t,paymentStatus:"pending",serviceName:((a=i[0])==null?void 0:a.name)||"Servi√ßo",clientName:($==null?void 0:$.name)||"Cliente"})}):h=await p("/api/booking/consecutive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({providerId:o,date:x.toISOString().split("T")[0],startTime:m.startTime,paymentMethod:n,totalPrice:t,paymentStatus:"pending",serviceName:i.map(u=>u.name).join(", "),clientName:($==null?void 0:$.name)||"Cliente",services:l.map(u=>{const M=(P[o]||[]).find(je=>je.id===u);return{serviceId:u,duration:(M==null?void 0:M.duration)||30}})})}),!h.ok){const u=await h.json();throw new Error(u.error||"Erro ao criar agendamento")}v("confirmation")}catch(i){B({title:"Erro ao criar agendamento",description:i.message||"Tente novamente.",variant:"destructive"})}},Me=s=>{const t=P[s]||[];let a=0,i=0;return t&&t.length>0&&t.forEach(d=>{a+=d.duration||0,i+=d.price||0}),{duration:a,price:i}},{data:I,isLoading:T}=O({queryKey:["/api/provider-fees",o],queryFn:async()=>{if(!o)return null;const s=await p(`/provider-fees/${o}`);return s.ok?await s.json():null},enabled:!!o});function ge(s){switch(s==null?void 0:s.toLowerCase()){case"beleza":return e.jsx(ts,{className:"h-10 w-10"});case"sa√∫de":return e.jsx(ss,{className:"h-10 w-10"});case"automotivo":return e.jsx(es,{className:"h-10 w-10"});case"casa":return e.jsx(Qe,{className:"h-10 w-10"});default:return e.jsx(G,{className:"h-10 w-10"})}}function Oe(s){return ge(s)}function fe(s,t=!1){return t?e.jsx(G,{className:"h-8 w-8"}):e.jsx(G,{className:"h-10 w-10"})}const Re=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üéØ"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha sua √°rea"}),e.jsx("p",{className:"text-gray-600",children:"Selecione a categoria que melhor atende sua necessidade"})]}),me?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(X,{})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:W==null?void 0:W.map(s=>e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${f===s.id?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>Pe(s.id),disabled:me,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`text-2xl transition-transform group-hover:scale-110 ${f===s.id?"text-white":"text-teal-500"}`,children:ge(s.name)}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`font-semibold text-lg ${f===s.id?"text-white":"text-gray-800"}`,children:s.name}),e.jsx("p",{className:`text-sm mt-1 ${f===s.id?"text-white/80":"text-gray-500"}`,children:"Servi√ßos especializados"})]})]}),f===s.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-white"})})})]},s.id))})]}),ze=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üìÇ"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Selecione a categoria"}),e.jsx("p",{className:"text-gray-600",children:"Escolha o tipo de servi√ßo que voc√™ precisa"})]}),xe?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(X,{})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:Q==null?void 0:Q.map(s=>e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${j===s.id?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>Ie(s.id),disabled:xe,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`text-2xl transition-transform group-hover:scale-110 ${j===s.id?"text-white":"text-teal-500"}`,children:Oe(s.name)}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`font-semibold text-lg ${j===s.id?"text-white":"text-gray-800"}`,children:s.name}),e.jsx("p",{className:`text-sm mt-1 ${j===s.id?"text-white/80":"text-gray-500"}`,children:"Servi√ßos dispon√≠veis"})]})]}),j===s.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-white"})})})]},s.id))})]}),qe=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üõ†Ô∏è"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha seus servi√ßos"}),e.jsx("p",{className:"text-gray-600",children:"Selecione um ou mais servi√ßos que voc√™ precisa"})]}),U?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(X,{})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:y==null?void 0:y.map(s=>e.jsxs("div",{className:`group relative overflow-hidden rounded-xl transition-all duration-300 transform hover:scale-[1.01] ${l.includes(s.id)?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>{U||ue(s.id)},style:{cursor:U?"not-allowed":"pointer"},children:[e.jsx("div",{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx("div",{className:`w-8 h-8 sm:w-12 sm:h-12 rounded-full flex items-center justify-center transition-transform group-hover:scale-105 ${l.includes(s.id)?"bg-white/20":"bg-teal-100"}`,children:e.jsx("span",{className:"text-lg sm:text-xl",children:fe(s.name,!0)})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-base sm:text-lg ${l.includes(s.id)?"text-white":"text-gray-800"}`,children:s.name}),e.jsx("p",{className:`text-xs sm:text-sm mt-1 ${l.includes(s.id)?"text-white/80":"text-gray-600"}`,children:s.description.length>40?`${s.description.substring(0,40)}...`:s.description})]})]}),e.jsx("div",{className:"text-right"})]})}),l.includes(s.id)&&e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3",children:e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})})})]},s.id))})]}),Ae=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üìÖ"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha a data"}),e.jsx("p",{className:"text-gray-600",children:"Selecione quando voc√™ gostaria de agendar"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-200",children:e.jsx(Ye,{mode:"single",selected:x,onSelect:ke,disabled:s=>{const t=new Date;return t.setHours(0,0,0,0),s<t},className:"rounded-xl"})})}),x&&e.jsx("div",{className:"pt-6",children:e.jsxs(k,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:C,disabled:L,children:["Ver Prestadores ",e.jsx(_,{className:"ml-2 h-5 w-5"})]})})]}),_e=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üë•"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha o prestador"}),e.jsx("p",{className:"text-gray-600",children:"Selecione quem ir√° realizar seu servi√ßo"})]}),L?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-6",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Buscando prestadores..."}),e.jsx("p",{className:"text-gray-600",children:"Carregando profissionais dispon√≠veis para sua data"})]}):g&&g.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:g.map((s,t)=>{const a=Me(s.id),i=le[s.id];return e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${o===s.id?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"} ${i?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{!i&&!L&&Ee(s.id,a.duration,a.price)},disabled:i||L,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center transition-transform group-hover:scale-110 ${o===s.id?"bg-white/20":"bg-teal-100"}`,children:e.jsx("span",{className:"text-lg",children:"üë§"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${o===s.id?"text-white":"text-gray-800"}`,children:s.name}),e.jsx("p",{className:`text-sm mt-1 ${o===s.id?"text-white/80":"text-gray-600"}`,children:i?"Carregando servi√ßos...":"Prestador dispon√≠vel"})]})]}),e.jsxs("div",{className:"text-right",children:[P[s.id]&&P[s.id].length>0&&e.jsxs("div",{className:"space-y-1",children:[P[s.id].map((d,h)=>e.jsx("div",{className:"text-sm font-semibold text-neutral-800",children:`${d.name} - R$ ${(Number(d.price)/100).toFixed(2).replace(".",",")}`},d.id)),e.jsxs("div",{className:"text-xs text-neutral-600 border-t pt-1",children:["Total: R$ ",(a.price/100).toFixed(2).replace(".",",")]})]}),e.jsxs("div",{className:`text-sm ${o===s.id?"text-white/70":"text-gray-500"}`,children:[a.duration," min"]})]})]}),o===s.id&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-white"})})})]},s.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üòî"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Nenhum prestador dispon√≠vel para esta data."})]}),o&&e.jsx("div",{className:"pt-6",children:e.jsxs(k,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:C,disabled:le[o]||L,children:["Escolher Hor√°rio ",e.jsx(_,{className:"ml-2 h-5 w-5"})]})})]}),Be=()=>!o||!x?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-yellow-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"‚ö†Ô∏è"})}),e.jsx("p",{className:"text-yellow-800 font-semibold",children:"Dados insuficientes para buscar hor√°rios."}),e.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Selecione um prestador e uma data."})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"‚è∞"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Escolha o hor√°rio"}),e.jsx("p",{className:"text-gray-600",children:x&&`Para ${be(x,"dd 'de' MMMM 'de' yyyy",{locale:Ne})}`})]}),z&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-2xl mb-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-500"})}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Carregando hor√°rios dispon√≠veis..."})]}),!z&&V.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üòî"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Nenhum hor√°rio dispon√≠vel para esta data."})]}),!z&&V.length>0&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:V.map((s,t)=>e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-4 transition-all duration-300 transform hover:scale-[1.02] ${(m==null?void 0:m.startTime)===s.startTime?"bg-gradient-to-br from-teal-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg"}`,onClick:()=>De(s),children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`font-bold text-lg ${(m==null?void 0:m.startTime)===s.startTime?"text-white":"text-gray-800"}`,children:s.startTime}),e.jsxs("div",{className:`text-sm ${(m==null?void 0:m.startTime)===s.startTime?"text-white/80":"text-gray-500"}`,children:["at√© ",s.endTime]})]}),(m==null?void 0:m.startTime)===s.startTime&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-5 h-5 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-3 h-3 text-white"})})})]},t))}),m&&e.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-2xl",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"h-4 w-4 text-white"})}),e.jsxs("span",{className:"text-green-800 font-semibold",children:["Hor√°rio selecionado: ",m.startTime," - ",m.endTime]})]})}),m&&e.jsx("div",{className:"pt-6",children:e.jsxs(k,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:C,disabled:z,children:["Ir para Pagamento ",e.jsx(_,{className:"ml-2 h-5 w-5"})]})})]}),He=()=>{const s=(y==null?void 0:y.filter(d=>l.includes(d.id)))||[],t=g==null?void 0:g.find(d=>d.id===o),a=(I==null?void 0:I.fixedFee)||0,i=R+a;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-2xl mb-4",children:e.jsx("span",{className:"text-2xl",children:"üí≥"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"M√©todo de pagamento"}),e.jsx("p",{className:"text-gray-600",children:"Escolha como voc√™ deseja pagar"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-2xl border border-gray-200",children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üìã"}),"Resumo do agendamento"]}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Servi√ßos:"}),e.jsxs("span",{className:"font-semibold text-gray-800",children:[s.length," servi√ßo(s)"]})]}),s.map((d,h)=>e.jsx("div",{className:"ml-4 text-sm border-l-2 border-teal-200 pl-3 py-1 bg-white/50 rounded-r-lg",children:e.jsx("span",{className:"text-gray-700",children:d.name})},d.id)),e.jsxs("div",{className:"mt-3 border-t border-gray-200 pt-3 flex justify-between text-sm font-semibold",children:[e.jsx("span",{children:"Dura√ß√£o total:"}),e.jsxs("span",{className:"text-teal-600",children:[F," minutos"]})]}),R>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm font-semibold",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{className:"text-teal-600",children:`R$ ${(R/100).toFixed(2).replace(".",",")}`})]}),a>0&&e.jsxs("div",{className:"flex justify-between text-sm font-semibold",children:[e.jsx("span",{children:"Taxa administrativa:"}),e.jsxs("span",{className:"text-teal-600",children:["R$ ",(a/100).toFixed(2).replace(".",",")]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t border-teal-200 pt-3 mt-3 bg-white/50 rounded-lg p-3",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-teal-600",children:["R$ ",(i/100).toFixed(2).replace(".",",")]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Prestador:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:(t==null?void 0:t.name)||"Prestador selecionado"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Data:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:x?be(x,"dd 'de' MMMM 'de' yyyy",{locale:Ne}):"Data selecionada"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Hor√°rio:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:m?`${m.startTime} - ${m.endTime}`:"Hor√°rio selecionado"})]})]})]})]}),D?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:D==="local"?"Escolha como deseja pagar no local":"Escolha como deseja pagar online"}),e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>re(null),className:"text-sm hover:bg-gray-100",disabled:T,children:"Voltar"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:D==="local"?e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="money"?"bg-gradient-to-br from-green-500 to-emerald-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-green-300 hover:shadow-lg"}`,onClick:()=>q("money"),disabled:T,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="money"?"bg-white/20":"bg-green-100"}`,children:e.jsx("span",{className:"text-xl",children:"üíµ"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="money"?"text-white":"text-gray-800"}`,children:"Dinheiro"}),e.jsx("p",{className:`text-sm mt-1 ${n==="money"?"text-white/80":"text-gray-600"}`,children:"Pagamento em dinheiro"})]})]}),n==="money"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-white"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="credit_card"?"bg-gradient-to-br from-blue-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-blue-300 hover:shadow-lg"}`,onClick:()=>q("credit_card"),disabled:T,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="credit_card"?"bg-white/20":"bg-blue-100"}`,children:e.jsx("span",{className:"text-xl",children:"üí≥"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="credit_card"?"text-white":"text-gray-800"}`,children:"Cart√£o de Cr√©dito"}),e.jsx("p",{className:`text-sm mt-1 ${n==="credit_card"?"text-white/80":"text-gray-600"}`,children:"Pague com cart√£o de cr√©dito"})]})]}),n==="credit_card"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-white"})})})]}),e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="debit_card"?"bg-gradient-to-br from-green-500 to-cyan-500 text-white shadow-xl":"bg-white border border-gray-200 hover:border-green-300 hover:shadow-lg"}`,onClick:()=>q("debit_card"),disabled:T,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="debit_card"?"bg-white/20":"bg-green-100"}`,children:e.jsx("span",{className:"text-xl",children:"üè¶"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="debit_card"?"text-white":"text-gray-800"}`,children:"Cart√£o de D√©bito"}),e.jsx("p",{className:`text-sm mt-1 ${n==="debit_card"?"text-white/80":"text-gray-600"}`,children:"Pague com cart√£o de d√©bito"})]})]}),n==="debit_card"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-white"})})})]}),e.jsxs("button",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] ${n==="pix"?"bg-gradient-to-br from-yellow-400 to-green-400 text-white shadow-xl":"bg-white border border-gray-200 hover:border-yellow-400 hover:shadow-lg"}`,onClick:()=>q("pix"),disabled:T,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110 ${n==="pix"?"bg-white/20":"bg-yellow-100"}`,children:e.jsx("span",{className:"text-xl",children:"‚ö°"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold text-lg ${n==="pix"?"text-white":"text-gray-800"}`,children:"PIX"}),e.jsx("p",{className:`text-sm mt-1 ${n==="pix"?"text-white/80":"text-gray-600"}`,children:"Pague com PIX (QR Code)"})]})]}),n==="pix"&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-white"})})})]})]})})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("button",{className:"group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-[1.02] bg-white border border-gray-200 hover:border-teal-300 hover:shadow-lg",onClick:()=>Fe("local"),disabled:T,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center transition-transform group-hover:scale-110",children:e.jsx("span",{className:"text-2xl",children:"üíµ"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:"Pagamento Local"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Pague diretamente ao prestador no dia do servi√ßo"})]})]})}),e.jsx("button",{className:"group relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform opacity-60 cursor-not-allowed bg-white border border-gray-200",disabled:!0,title:"Em breve dispon√≠vel",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-gray-400 to-gray-500 rounded-2xl flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"üí≥"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-500",children:"Pagamento Online"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Em breve dispon√≠vel"})]})]})})]})}),D&&n&&e.jsx("div",{className:"pt-6",children:e.jsxs(k,{className:"w-full h-14 rounded-xl text-lg font-bold shadow-lg bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white transition-all transform hover:scale-[1.02]",onClick:Le,disabled:T,children:["Finalizar Agendamento ",e.jsx(_,{className:"ml-2 h-5 w-5"})]})})]})},Ke=()=>e.jsx("div",{className:"space-y-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center mb-6 shadow-xl",children:e.jsx("span",{className:"text-4xl",children:"‚úÖ"})}),e.jsx("h2",{className:"text-3xl font-bold mb-3 text-gray-800",children:"Agendamento Confirmado!"}),e.jsx("p",{className:"text-gray-600 mb-6 text-lg",children:"Seu agendamento foi realizado com sucesso."}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-2xl border border-green-200 mb-6",children:e.jsx("p",{className:"text-green-800 font-semibold",children:"Voc√™ receber√° uma confirma√ß√£o por email em breve."})}),e.jsx(k,{className:"bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white px-8 py-3 rounded-xl font-semibold shadow-lg transition-all transform hover:scale-105",onClick:()=>window.location.href="/client/booking-confirmation-page",children:"Ver meus agendamentos"})]})}),Ve=()=>{switch(r){case"niche":return"Escolha a √°rea de servi√ßo";case"category":return"Selecione a categoria";case"service":return"Qual servi√ßo voc√™ precisa?";case"date":return"Selecione uma data";case"providers":return"Prestadores dispon√≠veis";case"time-slot":return"Escolha um hor√°rio";case"payment":return"Escolha o m√©todo de pagamento";case"confirmation":return"Confirma√ß√£o do Agendamento";default:return"Novo Agendamento"}},A=["niche","category","service","date","providers","time-slot","payment","confirmation"];return e.jsxs("div",{className:"min-h-screen w-full bg-white relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-teal-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-blue-500/5 rounded-full blur-2xl"})]}),e.jsx("div",{className:"relative z-10 pt-6 pb-4",children:e.jsx("div",{className:"max-w-md mx-auto px-4",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-4 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{className:`rounded-xl bg-gray-100 p-3 transition-all hover:bg-gray-200 hover:scale-105 ${r==="niche"||r==="confirmation"?"invisible":""}`,onClick:Te,"aria-label":"Voltar",disabled:r==="niche"||r==="confirmation",style:{pointerEvents:r==="niche"||r==="confirmation"?"none":"auto"},children:e.jsx(Ze,{className:"h-5 w-5 text-neutral-700"})}),e.jsx("h2",{className:"text-lg font-extrabold text-neutral-900 text-center flex-1",children:Ve()}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-teal-400 to-cyan-400 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${(A.indexOf(r)+1)/A.length*100}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-neutral-500",children:[e.jsxs("span",{children:["Passo ",A.indexOf(r)+1]}),e.jsxs("span",{children:["de ",A.length]})]})]})]})})}),e.jsx("div",{className:"relative z-10 px-4 pb-8",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx("div",{className:"bg-white/95 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/30 overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"min-h-[400px] flex flex-col justify-center",children:[r==="niche"&&Re(),r==="category"&&ze(),r==="service"&&qe(),r==="date"&&Ae(),r==="providers"&&_e(),r==="time-slot"&&Be(),r==="payment"&&He(),r==="confirmation"&&Ke()]})})})})}),Ce&&N&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-teal-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl",children:fe(N.name)})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:N.name})]}),e.jsx("button",{onClick:()=>J(!1),className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors",children:e.jsx("span",{className:"text-gray-600",children:"√ó"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Descri√ß√£o"}),e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:N.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Pre√ßo"}),e.jsxs("div",{className:"font-bold text-teal-600 text-lg",children:["R$ ",(N.price/100).toFixed(2).replace(".",",")]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Dura√ß√£o"}),e.jsxs("div",{className:"font-bold text-gray-800 text-lg",children:[N.duration," min"]})]})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>J(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Fechar"}),e.jsx("button",{onClick:()=>{ue(N.id),J(!1)},className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${l.includes(N.id)?"bg-gray-500 text-white":"bg-teal-500 text-white hover:bg-teal-600"}`,children:l.includes(N.id)?"J√° Selecionado":"Selecionar Servi√ßo"})]})]})})]})}function Is(){const[Y,S]=ye(),[B,$]=c.useState(null);c.useEffect(()=>{const v=new URLSearchParams(window.location.search).get("serviceId");v&&!isNaN(parseInt(v))&&console.log("Par√¢metro serviceId detectado, mas n√£o usado para pr√©-sele√ß√£o:",v)},[Y]);const H=r=>{if(console.log("Agendamento finalizado com dados:",r),r.date&&r.startTime&&r.endTime&&r.paymentMethod){const v=r.serviceId||(r.serviceIds&&r.serviceIds.length>0?r.serviceIds[0]:0),f=r.serviceIds&&r.serviceIds.length>1;let E=`/client/booking-confirmation/${r.providerId}/${v}/${r.date}/${r.startTime}/${r.endTime}`;if(f&&r.serviceIds){const j=r.serviceIds.slice(1).join(",");E+=`?additionalServices=${j}`}S(E)}};return e.jsxs(e.Fragment,{children:[e.jsx(Ue,{children:e.jsx("title",{children:"Agendar Servi√ßo | AgendoAI"})}),e.jsx(Xe,{children:e.jsxs("div",{className:"w-full min-h-screen flex flex-col items-center bg-white",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-neutral-900 mb-4 text-center mt-4 tracking-tight",children:"Novo agendamento"}),e.jsx("div",{className:"w-full flex-1 flex flex-col items-center",children:e.jsx(as,{onComplete:H,preSelectedServiceId:null})})]})})]})}export{Is as default};
