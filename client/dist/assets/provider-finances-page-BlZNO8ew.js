import{m as V,u as U,c as G,r as E,d as A,j as e,C as o,f as x,g as m,i as h,y as l,h as f,K as q}from"./index-DOe1OCu1.js";import{u as J}from"./useMutation-Lmj9MX3Y.js";import{P as K}from"./provider-layout-nV42KACr.js";import{T as Y,a as $,b as L,c as P}from"./tabs-BbH-RVGd.js";import{T as W,b as F,c as u,d as r,e as I,f as t}from"./table-CpYERuu-.js";import{B as N}from"./button-C168b4m4.js";import{I as z}from"./input-BHH75Tpk.js";import{L as Q}from"./label-MMklymaS.js";import{D as X,a as Z,b as _,c as ee,d as se}from"./dialog-DsJAgbDW.js";import{S as i}from"./skeleton-B-0dSqkR.js";import{W as ae}from"./wallet-BB9nbDPl.js";import{C as te}from"./calendar-Mn3IWFfL.js";import{D as re}from"./dollar-sign-D5ikk9cU.js";import{R as k}from"./refresh-ccw-C7fJHNqO.js";import"./arrow-left-BPt4aJQo.js";import"./index-DbsNQ1RS.js";import"./index-CQF81cx3.js";import"./index-DdZceiuF.js";import"./index-DxOiueDc.js";import"./index-CtQ14QdP.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=V("CircleArrowDown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);function ye(){const{user:n}=U(),{toast:d}=G(),[g,D]=E.useState(""),[M,j]=E.useState(!1);n==null||n.id;const{data:a={providerId:(n==null?void 0:n.id)||0,availableBalance:0,pendingBalance:0,totalEarnings:0,lastUpdated:new Date().toISOString()},isLoading:p,refetch:O}=A({queryKey:["/api/provider/balance"],refetchOnWindowFocus:!1,enabled:!1}),{data:c=[],isLoading:v,refetch:b}=A({queryKey:["/api/provider/transactions"],refetchOnWindowFocus:!1,enabled:!1}),T=J({mutationFn:async s=>(d({title:"Funcionalidade desativada",description:"O sistema de marketplace foi removido. Esta funcionalidade não está mais disponível.",variant:"destructive"}),null),onSuccess:()=>{d({title:"Solicitação enviada",description:"Sua solicitação de saque foi enviada com sucesso e será processada em breve."}),j(!1),D(""),O(),b()},onError:s=>{d({title:"Erro na solicitação",description:s.message||"Ocorreu um erro ao processar sua solicitação de saque.",variant:"destructive"})}}),H=()=>{const s=parseFloat(g.replace(/[^\d.]/g,""));if(isNaN(s)||s<=0){d({title:"Valor inválido",description:"Por favor, insira um valor válido para saque.",variant:"destructive"});return}if(a&&s>a.availableBalance){d({title:"Saldo insuficiente",description:"O valor solicitado excede seu saldo disponível para saque.",variant:"destructive"});return}T.mutate(s)},R=s=>({PAYMENT:"Pagamento",FEE:"Taxa",WITHDRAWAL:"Saque",ADJUSTMENT:"Ajuste"})[s]||s,y=s=>({PENDING:"Pendente",COMPLETED:"Concluído",FAILED:"Falhou",CANCELED:"Cancelado"})[s]||s,S=s=>{switch(s){case"COMPLETED":return"text-green-600";case"PENDING":return"text-yellow-600";case"FAILED":case"CANCELED":return"text-red-600";default:return""}},C=(s,w)=>s==="PAYMENT"?"text-green-600":s==="FEE"||s==="WITHDRAWAL"?"text-red-600":s==="ADJUSTMENT"?w>=0?"text-green-600":"text-red-600":"";return e.jsx(K,{children:e.jsxs("div",{className:"container py-6",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight mb-8",children:"Finanças"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(o,{children:[e.jsx(x,{className:"pb-2",children:e.jsxs(m,{className:"text-lg flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5 text-primary"}),"Saldo Disponível"]})}),e.jsxs(h,{children:[p?e.jsx(i,{className:"h-10 w-32"}):e.jsx("div",{className:"text-3xl font-bold text-primary",children:l((a==null?void 0:a.availableBalance)||0)}),e.jsx("div",{className:"mt-4",children:e.jsxs(N,{onClick:()=>j(!0),disabled:p||!a||a.availableBalance<=0,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Solicitar Saque"]})})]})]}),e.jsxs(o,{children:[e.jsxs(x,{className:"pb-2",children:[e.jsxs(m,{className:"text-lg flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5 text-yellow-500"}),"Saldo Pendente"]}),e.jsx(f,{children:"Valores em processamento"})]}),e.jsx(h,{children:p?e.jsx(i,{className:"h-10 w-32"}):e.jsx("div",{className:"text-3xl font-bold text-yellow-500",children:l((a==null?void 0:a.pendingBalance)||0)})})]}),e.jsxs(o,{children:[e.jsxs(x,{className:"pb-2",children:[e.jsxs(m,{className:"text-lg flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-green-500"}),"Ganhos Totais"]}),e.jsx(f,{children:"Desde o início"})]}),e.jsx(h,{children:p?e.jsx(i,{className:"h-10 w-32"}):e.jsx("div",{className:"text-3xl font-bold text-green-500",children:l((a==null?void 0:a.totalEarnings)||0)})})]})]}),e.jsxs(Y,{defaultValue:"transactions",className:"w-full",children:[e.jsxs($,{className:"mb-4",children:[e.jsx(L,{value:"transactions",children:"Transações"}),e.jsx(L,{value:"withdrawals",children:"Saques"})]}),e.jsx(P,{value:"transactions",children:e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsxs(m,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Histórico de Transações"}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>b(),disabled:v,children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Atualizar"]})]}),e.jsx(f,{children:"Seus pagamentos recebidos e taxas cobradas são listados aqui."})]}),e.jsx(h,{children:v?e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"h-10 w-full"}),e.jsx(i,{className:"h-10 w-full"}),e.jsx(i,{className:"h-10 w-full"})]}):c&&c.length>0?e.jsxs(W,{children:[e.jsx(F,{children:e.jsxs(u,{children:[e.jsx(r,{children:"Data"}),e.jsx(r,{children:"Tipo"}),e.jsx(r,{children:"Descrição"}),e.jsx(r,{children:"Valor"}),e.jsx(r,{children:"Status"})]})}),e.jsx(I,{children:c.map(s=>e.jsxs(u,{children:[e.jsx(t,{children:q(new Date(s.transactionDate))}),e.jsx(t,{children:e.jsx("span",{className:C(s.type,s.amount),children:R(s.type)})}),e.jsx(t,{children:s.description}),e.jsx(t,{className:C(s.type,s.amount),children:s.type==="PAYMENT"||s.type==="ADJUSTMENT"&&s.amount>=0?`+${l(s.amount)}`:`-${l(Math.abs(s.amount))}`}),e.jsx(t,{children:e.jsx("span",{className:S(s.status),children:y(s.status)})})]},s.id))})]}):e.jsx("div",{className:"text-center text-muted-foreground py-10",children:"Nenhuma transação encontrada."})})]})}),e.jsx(P,{value:"withdrawals",children:e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsx(m,{children:"Histórico de Saques"}),e.jsx(f,{children:"Seus pedidos de saque e status."})]}),e.jsx(h,{children:v?e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"h-10 w-full"}),e.jsx(i,{className:"h-10 w-full"})]}):c?e.jsxs(W,{children:[e.jsx(F,{children:e.jsxs(u,{children:[e.jsx(r,{children:"Data"}),e.jsx(r,{children:"Valor"}),e.jsx(r,{children:"Status"})]})}),e.jsxs(I,{children:[c.filter(s=>s.type==="WITHDRAWAL").map(s=>e.jsxs(u,{children:[e.jsx(t,{children:q(new Date(s.transactionDate))}),e.jsx(t,{children:l(s.amount)}),e.jsx(t,{children:e.jsx("span",{className:S(s.status),children:y(s.status)})})]},s.id)),c.filter(s=>s.type==="WITHDRAWAL").length===0&&e.jsx(u,{children:e.jsx(t,{colSpan:3,className:"text-center text-muted-foreground py-6",children:"Nenhum saque encontrado."})})]})]}):e.jsx("div",{className:"text-center text-muted-foreground py-10",children:"Nenhum saque encontrado."})})]})})]}),e.jsx(X,{open:M,onOpenChange:j,children:e.jsxs(Z,{children:[e.jsxs(_,{children:[e.jsx(ee,{children:"Solicitar Saque"}),e.jsx(se,{children:"Solicite o saque de fundos disponíveis em sua conta."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"withdrawal-amount",children:"Valor para saque"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"bg-muted px-3 py-2 border border-r-0 rounded-l-md",children:"R$"}),e.jsx(z,{id:"withdrawal-amount",placeholder:"0,00",value:g,onChange:s=>D(s.target.value),className:"rounded-l-none"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:["Saldo disponível: ",l((a==null?void 0:a.availableBalance)||0)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>j(!1),children:"Cancelar"}),e.jsx(N,{type:"button",onClick:H,disabled:T.isPending||!g,children:T.isPending?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"mr-2 h-4 w-4 animate-spin"}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Solicitar Saque"]})})]})]})]})})]})})}export{ye as default};
