import{j as e}from"./ui-UIpCtT3r.js";import{r as u}from"./vendor-vA4cx1mx.js";import{j as H,b as U,c as D,C as T,d as F,e as q,f as z,g as A,m as J,q as N,i as l}from"./index-BJ9Cw0LR.js";import{u as w}from"./useMutation-CDdW0pzE.js";import{D as W,a as X,b as Y,c as Z,d as _,e as ee}from"./dialog-BlryVO8p.js";import{F as re,a as p,b as x,c as g,d as h,e as b,f as se}from"./form-Cf7t4W3I.js";import{u as oe,t as ie,o as ae,s as j}from"./zod-BPPSwYm9.js";import{I as P}from"./input-CNw_l4dQ.js";import{B as t}from"./button-BvsVcTDx.js";import{T as te}from"./textarea-6aMtToLP.js";import{S as ne,a as de,b as le,c as ce,d as S}from"./select-hCrJFe1P.js";import{A as me,b as ue,a as pe}from"./alert-D4b1dLXp.js";import{A as xe}from"./admin-layout-I_J5o8A_.js";import{P as k}from"./plus-C7D4Nhz_.js";import{S as ge}from"./square-pen-C0q5CO78.js";import"./router-CxXythJb.js";import"./label-qfvszZNj.js";import"./index-BdQq_4o_.js";import"./index-BH3L9zMK.js";import"./chevron-down-Dg2l6tfZ.js";import"./check-ZbxB06uW.js";import"./navbar-YJYqy7V_.js";import"./proxy-Bw6ASuXk.js";import"./house-CCMYCVaH.js";import"./search-ByWcnwgm.js";import"./calendar-check-DUwfC2Eu.js";import"./user-C2y4PfJ8.js";import"./badge-BQpU5zw7.js";import"./avatar-DEanbPY_.js";import"./dropdown-menu-Dyfg7Gk4.js";import"./chevron-right-CATzdtP3.js";import"./circle-CxgECyF4.js";import"./settings-WRZm2y6w.js";import"./log-out-CdVFLkWN.js";import"./menu-B7gXVrLX.js";import"./bell-vRE7a1ng.js";import"./arrow-left-EWHBe2nW.js";import"./users-ZhvK7Ip9.js";import"./calendar-tibBNAR3.js";import"./trending-up-BcBXLPRG.js";import"./folder-tree-Duy3Amda.js";import"./credit-card-CO61cKh_.js";import"./share-2-B19OuGMQ.js";import"./circle-help-CxLgceap.js";import"./book-open-Esw08_-n.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=H("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),be=ae({name:j().min(3,{message:"O nome deve ter pelo menos 3 caracteres"}),description:j().optional(),categoryId:j().min(1,{message:"Selecione uma categoria"}),duration:j().min(1,{message:"Informe a duração em minutos"})});function lr(){const{toast:a}=U(),[o,v]=u.useState(null),[L,c]=u.useState(!1),[n,C]=u.useState(null),{data:f,isLoading:O,error:M}=D({queryKey:["/api/services"],queryFn:async()=>{try{return await(await l("GET","/api/services")).json()}catch(r){return console.error("Erro ao carregar serviços:",r),[]}}}),{data:d,isLoading:V}=D({queryKey:["/api/categories"],queryFn:async()=>{try{return await(await l("GET","/api/categories")).json()}catch(r){return console.error("Erro ao carregar categorias:",r),[]}}}),i=oe({resolver:ie(be),defaultValues:{name:"",description:"",categoryId:"",duration:"30"}});u.useEffect(()=>{o?i.reset({name:o.name,description:o.description||"",categoryId:String(o.categoryId),duration:String(o.duration)}):i.reset({name:"",description:"",categoryId:"",duration:"30"})},[o,i]);const E=w({mutationFn:async r=>await(await l("POST","/api/services",{...r,duration:parseInt(r.duration),categoryId:parseInt(r.categoryId),price:0,isActive:!0})).json(),onSuccess:()=>{N.invalidateQueries({queryKey:["/api/services"]}),a({title:"Serviço criado",description:"O serviço foi criado com sucesso."}),i.reset({name:"",description:"",categoryId:"",duration:"30"})},onError:r=>{a({title:"Erro ao criar serviço",description:r.message,variant:"destructive"})}}),I=w({mutationFn:async({id:r,data:s})=>await(await l("PUT",`/api/services/${r}`,{...s,duration:parseInt(s.duration),categoryId:parseInt(s.categoryId)})).json(),onSuccess:()=>{N.invalidateQueries({queryKey:["/api/services"]}),a({title:"Serviço atualizado",description:"O serviço foi atualizado com sucesso."}),v(null),i.reset({name:"",description:"",categoryId:"",duration:"30"})},onError:r=>{a({title:"Erro ao atualizar serviço",description:r.message,variant:"destructive"})}}),y=w({mutationFn:async r=>{const s=await l("DELETE",`/api/services/${r}`);if(!s.ok){const m=await s.json();throw new Error(m.message||"Erro ao excluir serviço")}return!0},onSuccess:()=>{N.invalidateQueries({queryKey:["/api/services"]}),a({title:"Serviço excluído",description:"O serviço foi excluído com sucesso."}),c(!1),C(null)},onError:r=>{a({title:"Erro ao excluir serviço",description:r.message,variant:"destructive"})}}),K=r=>{o?I.mutate({id:o.id,data:r}):E.mutate(r)},R=r=>{v(r),i.reset({name:r.name,description:r.description||"",categoryId:String(r.categoryId),duration:String(r.duration)})},B=r=>{C(r),c(!0)},G=()=>{n&&y.mutate(n.id)},Q=()=>{v(null),i.reset({name:"",description:"",categoryId:"",duration:"30"})},$=r=>{if(!d)return"Carregando...";const s=d.find(m=>m.id===r);return s?s.name:"Categoria não encontrada"};return e.jsx(xe,{children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 pb-20",children:[e.jsx("div",{className:"sticky top-0 z-30 bg-gradient-to-r from-blue-100/80 to-indigo-100/80 backdrop-blur border-b border-blue-100 shadow-sm mb-8",children:e.jsx("div",{className:"container max-w-5xl mx-auto flex items-center justify-between py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-500 p-2 rounded-xl shadow-lg",children:e.jsx(k,{className:"h-6 w-6 text-white"})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold text-blue-900",children:"Gerenciar Serviços"})]})})}),e.jsx("div",{className:"container p-4 max-w-5xl",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsxs(T,{className:"shadow-2xl border-2 border-blue-100 rounded-2xl bg-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-gradient-to-br from-blue-100/60 to-indigo-100/40 rounded-full blur-2xl z-0"}),e.jsxs(F,{className:"relative z-10",children:[e.jsxs(q,{className:"flex items-center gap-2 text-blue-900",children:[e.jsx(k,{className:"h-6 w-6 text-blue-500"}),o?"Editar Tipo de Serviço":"Novo Tipo de Serviço"]}),e.jsx(z,{children:o?"Atualize os detalhes deste tipo de serviço":"Adicione um novo tipo de serviço que os prestadores poderão oferecer"}),e.jsx("div",{className:"mt-2 p-3 bg-gradient-to-r from-blue-100 to-indigo-100 rounded-xl border border-blue-200 text-blue-700 text-sm",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Nota:"})," Como administrador, você cadastra apenas os tipos de serviços disponíveis na plataforma. Os prestadores selecionarão quais destes serviços oferecem e definirão seus próprios preços e durações específicas."]})})]}),e.jsx(A,{className:"relative z-10",children:e.jsx(re,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(K),className:"space-y-6",children:[e.jsx(p,{control:i.control,name:"name",render:({field:r})=>e.jsxs(x,{children:[e.jsx(g,{children:"Nome do Serviço"}),e.jsx(h,{children:e.jsx(P,{placeholder:"Ex: Corte de Cabelo",...r,className:"rounded-lg border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-white"})}),e.jsx(b,{})]})}),e.jsx(p,{control:i.control,name:"description",render:({field:r})=>e.jsxs(x,{children:[e.jsx(g,{children:"Descrição"}),e.jsx(h,{children:e.jsx(te,{placeholder:"Descrição do serviço",...r,rows:3,className:"rounded-lg border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-white"})}),e.jsx(b,{})]})}),e.jsx(p,{control:i.control,name:"categoryId",render:({field:r})=>e.jsxs(x,{children:[e.jsx(g,{children:"Categoria"}),e.jsxs(ne,{onValueChange:r.onChange,defaultValue:r.value,value:r.value,children:[e.jsx(h,{children:e.jsx(de,{className:"rounded-lg border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-white",children:e.jsx(le,{placeholder:"Selecione uma categoria"})})}),e.jsx(ce,{className:"bg-white border-2 border-blue-100 shadow-xl rounded-lg",children:V?e.jsx(S,{value:"loading",disabled:!0,children:"Carregando categorias..."}):d&&d.length>0?d.map(s=>e.jsx(S,{value:String(s.id),children:e.jsx("span",{className:"inline-flex items-center gap-2",children:e.jsx("span",{className:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full text-xs font-semibold",children:s.name})})},s.id)):e.jsx(S,{value:"empty",disabled:!0,children:"Nenhuma categoria disponível"})})]}),e.jsx(b,{})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsx(p,{control:i.control,name:"duration",render:({field:r})=>e.jsxs(x,{children:[e.jsx(g,{children:"Duração de Referência (minutos)"}),e.jsx(h,{children:e.jsx(P,{type:"number",min:"5",step:"5",placeholder:"30",...r,className:"rounded-lg border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 bg-white"})}),e.jsx(se,{children:"Tempo estimado de referência. Cada prestador poderá definir sua própria duração."}),e.jsx(b,{})]})})}),e.jsxs("div",{className:"flex justify-between pt-2",children:[o&&e.jsx(t,{type:"button",variant:"outline",onClick:Q,className:"rounded-lg border-blue-200 hover:bg-blue-50",children:"Cancelar"}),e.jsxs(t,{type:"submit",disabled:E.isPending||I.isPending,className:`rounded-lg font-semibold shadow-md bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 px-8 py-2 text-base ${o?"ml-auto":"w-full"}`,children:[o?"Atualizar":"Adicionar"," Serviço"]})]})]})})})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(T,{className:"shadow-2xl border-2 border-blue-100 rounded-2xl bg-white",children:[e.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-gradient-to-br from-amber-100/60 to-yellow-100/40 rounded-full blur-2xl z-0"}),e.jsxs(F,{children:[e.jsx(q,{children:"Tipos de Serviços Disponíveis"}),e.jsx(z,{children:"Gerenciar os tipos de serviços que os prestadores poderão oferecer"}),e.jsx("div",{className:"mt-2 p-3 bg-gradient-to-r from-amber-100 to-yellow-50 rounded-xl border border-amber-200 text-amber-700 text-sm",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Lembre-se:"})," Os preços mostrados abaixo são apenas valores de referência. Cada prestador pode definir seu próprio preço ao oferecer estes serviços."]})})]}),e.jsx(A,{children:M?e.jsxs(me,{variant:"destructive",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx(ue,{children:"Erro"}),e.jsx(pe,{children:"Ocorreu um erro ao carregar os serviços."})]}):O?e.jsx("div",{className:"text-center py-6",children:"Carregando serviços..."}):f&&f.length>0?e.jsx("div",{className:"space-y-4",children:f.map((r,s)=>e.jsxs("div",{className:`rounded-xl border border-blue-100 shadow-md bg-white p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-4 transition-all ${s%2===0?"":"bg-blue-50"}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-lg font-bold text-blue-900 truncate",children:r.name}),e.jsx("span",{className:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full text-xs font-semibold",children:$(r.categoryId)})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Duração:"})," ",r.duration," min"]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Preço:"})," ",r.price===0?e.jsx("span",{className:"text-gray-500 italic",children:"Definido pelo prestador"}):(r.price/100).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Personalizado por prestador"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{variant:"ghost",size:"icon",onClick:()=>R(r),className:"hover:bg-blue-100",children:e.jsx(ge,{className:"h-4 w-4 text-blue-600"})}),e.jsx(t,{variant:"ghost",size:"icon",onClick:()=>B(r),className:"hover:bg-red-100",children:e.jsx(he,{className:"h-4 w-4 text-destructive"})})]})]},r.id))}):e.jsx("div",{className:"text-center py-6 text-muted-foreground",children:"Nenhum serviço encontrado. Adicione seu primeiro serviço!"})})]})})]})}),e.jsx(W,{open:L,onOpenChange:c,children:e.jsxs(X,{className:"bg-white border-2 border-red-100 shadow-2xl rounded-2xl",children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Excluir Serviço"}),e.jsxs(_,{children:['Tem certeza que deseja excluir o serviço "',n==null?void 0:n.name,'"? Esta ação não pode ser desfeita.']})]}),e.jsxs(ee,{children:[e.jsx(t,{variant:"outline",onClick:()=>c(!1),className:"rounded-lg border-blue-200 hover:bg-blue-50",children:"Cancelar"}),e.jsx(t,{variant:"destructive",onClick:G,disabled:y.isPending,className:"rounded-lg font-semibold shadow-md",children:y.isPending?"Excluindo...":"Excluir"})]})]})})]})})}export{lr as default};
