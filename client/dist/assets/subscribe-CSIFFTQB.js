import{r as i,c as j,j as s,e as f,C as p,o as y,H as S,f as N,g,i as b,k as v,h as C}from"./index-DlYle-HK.js";import{E as A,u as k,a as E,P as I}from"./react-stripe.esm-WwQILy7A.js";import{l as F}from"./index-C8r34K29.js";import{C as x}from"./client-layout-GJPJE_tb.js";import{B as w}from"./button-0YWTsIWD.js";import{A as T,a as D}from"./alert-Byp0y-1Q.js";import{C as l}from"./check-B4G7YtLf.js";import"./index-D4KYuKUS.js";import"./navbar-Dyja2Gc-.js";import"./proxy-CCHoB6Gf.js";import"./house-D2xh843T.js";import"./search-PoM2JzRB.js";import"./calendar-check-CYUwfGb3.js";import"./user-geZPnD2Z.js";const L=F("pk_test_51RkqXrRr6s3UmWYUrWgAlgej5ir5MpLUjjpQLkGPeHeg8vy3ZJAbIttYkjR3EzrI9zzvFgI6lPRMZhGj55NnIFYF00F1YurTA7"),R=()=>{const e=k(),n=E(),{toast:o}=j(),[a,t]=i.useState(!1),m=async c=>{if(c.preventDefault(),!e||!n){o({title:"Stripe não inicializado",description:"Tente novamente em alguns instantes",variant:"destructive"});return}t(!0);const{error:d}=await e.confirmPayment({elements:n,confirmParams:{return_url:`${window.location.origin}/client/subscription-confirmation`}});d&&o({title:"Falha na Assinatura",description:d.message||"Houve um erro ao processar a assinatura",variant:"destructive"}),t(!1)};return s.jsx("form",{onSubmit:m,children:s.jsxs(p,{children:[s.jsxs(N,{children:[s.jsx(g,{children:"Inscrever-se no Plano Premium"}),s.jsx(C,{children:"Preencha os dados do seu cartão para iniciar sua assinatura"})]}),s.jsx(b,{className:"space-y-4",children:s.jsx(I,{})}),s.jsx(v,{children:s.jsx(w,{type:"submit",className:"w-full",disabled:!e||a,children:a?s.jsxs(s.Fragment,{children:[s.jsx(f,{className:"mr-2 h-4 w-4 animate-spin"}),"Processando..."]}):"Assinar"})})]})})};function J(){const[e,n]=i.useState(""),[o,a]=i.useState(!0),[t,m]=i.useState(null),{toast:c}=j();return i.useEffect(()=>{(async()=>{var h;try{a(!0);const r=await fetch("/api/get-or-create-subscription",{method:"POST",headers:{"Content-Type":"application/json"}});if(!r.ok){const P=await r.json();throw new Error(((h=P.error)==null?void 0:h.message)||"Erro ao criar assinatura")}const u=await r.json();if(!u.clientSecret)throw new Error("Não foi possível iniciar o pagamento da assinatura");n(u.clientSecret)}catch(r){m(r.message),c({title:"Erro",description:r.message,variant:"destructive"})}finally{a(!1)}})()},[c]),o?s.jsx(x,{children:s.jsx("div",{className:"container mx-auto py-10 max-w-2xl",children:s.jsxs("div",{className:"flex items-center justify-center h-64",children:[s.jsx(f,{className:"h-8 w-8 animate-spin text-primary"}),s.jsx("span",{className:"ml-2",children:"Preparando sua assinatura..."})]})})}):t?s.jsx(x,{children:s.jsx("div",{className:"container mx-auto py-10 max-w-2xl",children:s.jsxs(p,{className:"p-6",children:[s.jsxs(T,{variant:"destructive",className:"mb-4",children:[s.jsx(y,{className:"h-4 w-4"}),s.jsx(D,{children:t})]}),s.jsx("p",{className:"mb-4",children:"Possíveis causas:"}),s.jsxs("ul",{className:"list-disc pl-5 mb-4 space-y-1",children:[s.jsx("li",{children:"O servidor pode não estar configurado com o ID de preço do Stripe"}),s.jsx("li",{children:"Você pode precisar estar autenticado para assinar"}),s.jsx("li",{children:"A conta do Stripe pode não estar configurada corretamente"})]}),s.jsx(w,{className:"mt-2",variant:"outline",onClick:()=>window.history.back(),children:"Voltar"})]})})}):s.jsxs(x,{children:[s.jsx(S,{children:s.jsx("title",{children:"Assinar Plano Premium | AgendoAI"})}),s.jsxs("div",{className:"container mx-auto py-10 max-w-2xl",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Plano Premium"}),s.jsx("div",{className:"mb-6",children:s.jsxs(p,{className:"mb-4",children:[s.jsx(N,{children:s.jsx(g,{children:"Benefícios do Plano Premium"})}),s.jsx(b,{children:s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-start",children:[s.jsx(l,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:"Agendamento prioritário com os melhores profissionais"})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx(l,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:"Descontos especiais em serviços selecionados"})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx(l,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:"Suporte prioritário"})]}),s.jsxs("li",{className:"flex items-start",children:[s.jsx(l,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:"Acesso a horários exclusivos"})]})]})}),s.jsxs(v,{className:"flex justify-between border-t pt-6",children:[s.jsx("span",{className:"text-muted-foreground",children:"Valor mensal:"}),s.jsx("span",{className:"font-semibold text-lg",children:"R$ 19,90"})]})]})}),e&&s.jsx(A,{stripe:L,options:{clientSecret:e,appearance:{theme:"stripe",variables:{colorPrimary:"#10b981",colorBackground:"#ffffff",colorText:"#1f2937"}}},children:s.jsx(R,{})})]})]})}export{J as default};
